<!DOCTYPE html>





<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 3.9.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.4.0">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.4.0">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.4.0">
  <link rel="mask-icon" href="/images/logo.svg?v=7.4.0" color="#222">

<link rel="stylesheet" href="/css/main.css?v=7.4.0">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.7.0">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '7.4.0',
    exturl: false,
    sidebar: {"position":"right","display":"hide","offset":12,"onmobile":true},
    copycode: {"enable":false,"show_result":false,"style":null},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":true},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: true,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: 'search.xml',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    translation: {
      copy_button: 'Copy',
      copy_success: 'Copied',
      copy_failure: 'Copy failed'
    },
    sidebarPadding: 40
  };
</script>

  <meta property="og:type" content="website">
<meta property="og:title" content="Brielley">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Brielley">
<meta property="og:locale" content="en">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Brielley">
  <link rel="canonical" href="http://yoursite.com/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: true,
    isPost: false,
    isPage: false,
    isArchive: false
  };
</script>

  <title>Brielley</title>
  








  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">
  <div class="container use-motion">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Brielley</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
      
      
      
        
        <li class="menu-item menu-item-what's-new">
      
    

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>What's New</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-tech">
      
    

    <a href="/categories/Tech/" rel="section"><i class="fa fa-fw fa-keyboard-o"></i>Tech</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-game">
      
    

    <a href="/categories/Game/" rel="section"><i class="fa fa-fw fa-gamepad"></i>Game</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-life">
      
    

    <a href="/categories/Life/" rel="section"><i class="fa fa-fw fa-paw"></i>Life</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-topics">
      
    

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>Topics</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-tags">
      
    

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>Tags</a>

  </li>
      <li class="menu-item menu-item-search">
        <a href="javascript:;" class="popup-trigger">
        
          <i class="fa fa-search fa-fw"></i>Search</a>
      </li>
    
  </ul>

    

</nav>
  <div class="site-search">
    <div class="popup search-popup">
    <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocorrect="off" autocapitalize="none"
           placeholder="Searching..." spellcheck="false"
           type="text" id="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result"></div>

</div>
<div class="search-pop-overlay"></div>

  </div>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <div id="posts" class="posts-expand">
       
        <article itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block home">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2021/01/02/notes-tech-unity-vfx/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Brielley">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Brielley">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
            
            <a href="/2021/01/02/notes-tech-unity-vfx/" class="post-title-link" itemprop="url">Unity项目画质改进的一些思路</a>
          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              
                
              

              <time title="Created: 2021-01-02 01:48:35" itemprop="dateCreated datePublished" datetime="2021-01-02T01:48:35+08:00">2021-01-02</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2021-03-23 14:46:31" itemprop="dateModified" datetime="2021-03-23T14:46:31+08:00">2021-03-23</time>
              </span>
            
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Tech/" itemprop="url" rel="index"><span itemprop="name">Tech</span></a></span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Tech/Game-Dev/" itemprop="url" rel="index"><span itemprop="name">Game Dev</span></a></span>

                
                
              
            </span>
          

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>用Unity做游戏一段时间应该都会发现，默认的画质会有一种仿佛表面蒙着一层白纱一样的泛白不清晰的感觉，即使把画质调到内置最高的ultra quality了还是会这样。虽然一般来说一开始选了unity而不是unreal来做游戏的人，基本上也没有在画质上有太高的追求，但这种仿佛眼镜花了一样的感觉还是会让人忍不住想要找块布来把眼镜擦擦干净。于是这篇笔记并不是面向对美术有高要求的人群，也不用于已有基础者进阶，而是对像我一样无论是在美术上还是在计算机图形学上都没什么基础也并不对游戏的美术质量抱太高要求但又希望能够一定程度改善画质的人，提供的一些最基础的画质改进思路。</p>
<p>一个比较彻底改善画质的思路是改渲染管线。unity有三种渲染管线，分别是默认的build-in render pipeline、universal render pipeline、high definition render pipeline，三种画质依次提升，同时吃硬件也依次提升。吃硬件这个问题特别值得拿出来说，因为是真的非常吃，我的电脑是4年前买的主流配置游戏本，960的显卡在如今已经没法玩新出的3A单机了，但玩守望先锋这样的游戏是不卡的，玩模4这样的游戏更是开最高效也很流畅，但是，一旦使用universal render pipeline，一个模型素材只有仅仅50M的低模游戏项目，设置medium quality运行不到1分钟就会明显感觉到卡顿，而且电脑发热严重，所以除非是定位超级硬核的游戏，还是不要考虑直接用urp做游戏了。urp开低效的话吃硬件程度稍好一点，但强烈不推荐，因为低效的影子锯齿严重到把抗锯齿调到最高也还是不行，视觉效果上还不如好好倒腾下的build-in，但比build-in的哪怕最高效也更吃硬件一点，非常得不偿失。但实测感觉urp的中效确实比build-in的最高效效果更好，如果希望做一个不吃硬件的游戏，又希望尽可能适当提升画面质量，我感觉比较实用是思路是只用urp开中效或者如果设备支持的话开高效做开头结尾过场动画，录成mp4格式的视频，通过raw image把视频直接嵌入build-in做的游戏项目中。而在build-in的主体项目中，尽量通过后期处理来提升画质，或者说修正那些画质中需要眼镜布擦一擦的地方。</p>
<p>我目前为止试出的在build-in项目里最具性价比的擦眼镜做法是：</p>
<p>1.把color space从gamma调整为linear。linear比gamma能从肉眼上直观感觉到细节的增加和泛白的减少，但不足之处是会让色调整体变暖。</p>
<p>2.安装unity可选包里的post-processing，设置一个global volumn，挂color grading组件，把tonemapping mode设置为aces模式。aces模式一改以后，会有一种画质瞬间上升两级的感觉，而且蒙着的白纱完全消失了，但不足之处是会让亮度整体变暗。</p>
<p>3.这步主要不为擦眼镜，而是为调整前两步的副作用。<br>3.1.对1导致的画面泛黄，用color grading里的white balance来调整色温；<br>3.2.对2导致的画面变暗，用color grading里的post-exposure来调亮，如果在使用post-exposure后发现总体亮度合适了但高光部分不够亮或阴影部分不够暗，就再结合color grading里的contrast来调整至理想的高光阴影亮度；<br>3.3.如果觉得擦眼镜后的画面过于清晰，不便于表现富于层次的近中远景，可以在lighting setting里勾选fog，模式改为线性，然后调整可见度距离至合适数值，来让中远景随距离逐渐模糊。不建议用post-processing里的depth of field组件来模糊中远景，除非是2D游戏或者是锁镜头的3D游戏，否则会很可能导致晕3D，尤其是在第一人称模式下。</p>

        
      
    </div>

    
    
    
      <footer class="post-footer">
          <div class="post-eof"></div>
        
      </footer>
  </div>
  
  
  
  </article>

       
    
       
        <article itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block home">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/08/15/notes-tech-music-making/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Brielley">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Brielley">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
            
            <a href="/2020/08/15/notes-tech-music-making/" class="post-title-link" itemprop="url">How to use IMSLP and GarageBand to make game music</a>
          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              
                
              

              <time title="Created: 2020-08-15 21:02:31" itemprop="dateCreated datePublished" datetime="2020-08-15T21:02:31+08:00">2020-08-15</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2021-03-23 14:44:48" itemprop="dateModified" datetime="2021-03-23T14:44:48+08:00">2021-03-23</time>
              </span>
            
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Tech/" itemprop="url" rel="index"><span itemprop="name">Tech</span></a></span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Tech/Game-Dev/" itemprop="url" rel="index"><span itemprop="name">Game Dev</span></a></span>

                
                
              
            </span>
          

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>音乐一直是制作游戏中的一个比较令人头秃的方面，在美术资源和音效资源有大量的免费开源资源可用的时候，音乐资源虽然也有那么一些，但大部分比较一言难尽，让人觉得不如不用的好。MSU的游戏开发网课里有提到可以用苹果自带的GarageBand来制作游戏音乐，制作出来的音乐版权是完全归制作者所有的。但这个方法的难点在于不是所有人都会演奏乐器比如我，作曲更是在大部分人的技能树外。但我最近发现，有一些取巧的方法可以用，比如使用那些已经超过70年进入公共版权的曲谱，在GarageBand的音轨里直接照谱编辑。当然，这个方法的限制也很多。大部分乐曲都很难用这个方法做出来，其一，虽然据说GarageBand支持触控对演奏力度的模拟，但如果像我这样不会演奏只能在音轨里编辑的，演奏出来的往往是比较生硬的，这使得那些需要很高演奏技巧的曲子都不适合，因为模拟不出演奏技巧后，曲子听起来会非常怪异，而即使并不需要高超的演奏技巧，但如果是独奏曲的话，出来的效果往往也很单调，如果是在本身有大量游戏音效的环境下轻量使用还好，如果是在需要音乐做重点烘托的地方就很煞风景；其二，这个软件本质还是给人做流行音乐而不是古典音乐的，于是做起古典音乐来很多地方都很受限制，首先可选节拍只有4/4，3/4，6/8三种，虽然可以尽量把别的节拍往这上面凑，但还是局限很大，2/2凑4/4或者12/8凑6/8这种还好，9/8这种就很麻烦，凑3/4或者6/8出来的强弱音不太对怎么听怎么别扭，其次乐器有大量流行乐用的吉他以及各种鼓以及各种电音和效果，但古典乐器就比较少，经常照谱凑不齐；其三，这个软件虽然理论上支持很多音轨，但音轨间的混音功能极其有限，于是三四个乐器音轨出来还好，音轨太多之后听起来就不太对了，虽然理论上它可以导出多轨工程文件，但它的格式是它自己的.band文件，没法导进adobe audition这种更适合做多轨混音效果的软件里面去做下一步，虽然也可以单独把每个音轨存成一个单独的音频文件，然后去audition里新建一个工程，但这样不太方便看出合奏效果，尤其如果需要整个音轨调高或调低多少半音八度或者所有音轨调整节奏速度这些功能还是在garageband里做起来比较方便，在audition里混音好做但这个不好做，但如果有需要的话，确实也可以，只是预算时间得大幅增加。总的来说，因为现在进入公共版权的绝大部分都是古典乐，于是这个方法能做的相当有限。我试验了十来首不同风格的曲子，感觉效果最好的是那种1轨钢琴加1-2轨弦乐这样的曲子，能最大限度地掩盖住单调平板的缺点，虽然听起来还是不太耐听，但在游戏里再加上音效混音后，也还勉强可用。</p>
<p>Tips：</p>
<p>1.在<a href="https://cn.imslp.org/wiki/Main_Page" target="_blank" rel="noopener">IMSLP</a>上搜索曲目的乐谱时，有两点需要注意的，一是一般来说会有挺多不同的版本的，不同版本之间不仅是出版社以及扫描清晰程度不同，有些的编曲也是不同的，可以选择其中比较适合演奏的版本，但需要注意不同谱子的版权，有的最近年间被人重新编曲的并不是公版；二是这网站的搜索框不是网站内置的搜索，而是链接的谷歌搜索，于是会打不开，可以用bing国际版搜索“site:imslp.org 曲名”，这样一般搜索出来的第一二个就是。</p>
<p>2.GarageBand里编辑音轨时对应的音高提示不是五线谱，而是标了调的乐器按键，在把IMSLP上找的五线谱编辑进去的时候，如果像我一样乐理水平有限，需要找表对照一下。</p>
<p>3.GarageBand导出的无损音乐文件比较大，一般放游戏里得用有损文件，但有损文件的格式是.m4a，unity里无法使用，需要先把.m4a丢进adobe audition里去转导出为.mp3格式，才能在unity里使用。</p>
<p>4.GarageBand的管类乐器比如长笛单簧管双簧管巴松法国号什么的，在键盘分类下面，别在大类里面去找，找不到的。</p>
<p>5.GarageBand的弦类乐器输入有两种方式，一种是直接在弦类大类里，好处除了对会演奏的人来说可以触控模拟演奏以外，还有就是可以直接选具体是哪种乐器小提琴中提琴大提琴还是低音贝司，但坏处是没法在音轨里直接整条音轨调整升降几个八度或半音，也没法选择演奏手法；另一种方式是在键盘大类下的其它分类里，好处是可以选三种演奏方式拨奏、断奏、延音，这样听起来演奏方式要丰富一些，也可以整条音轨调整升降几个八度或半音，但坏处是没法选择具体是哪种弦乐器。对于每支乐曲来说，选哪种方式最好的办法还是试吧，用不同效果做4-8个小节试听一下决定用哪种，也可能发现没一个听起来是对头的于是整首曲子被划掉，目前看来遇到最后这种情况的可能性其实是最大的。</p>
<p>6.音色上来说，GarageBand的钢琴高音比低音好听，弦乐低音比高音更友好，在谱子可选的情况下，尽量选钢琴是高声部，弦乐是低声部的大提琴协奏曲一类的效果比较好，弦乐高音钢琴低音的小提琴协奏曲一类的有时会比较辣耳朵。</p>

        
      
    </div>

    
    
    
      <footer class="post-footer">
          <div class="post-eof"></div>
        
      </footer>
  </div>
  
  
  
  </article>

       
    
       
        <article itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block home">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/08/15/notes-tech-unity-fungus/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Brielley">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Brielley">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
            
            <a href="/2020/08/15/notes-tech-unity-fungus/" class="post-title-link" itemprop="url">Unity插件I：Fungus</a>
          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              
                
              

              <time title="Created: 2020-08-15 21:02:26" itemprop="dateCreated datePublished" datetime="2020-08-15T21:02:26+08:00">2020-08-15</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2021-03-23 14:44:28" itemprop="dateModified" datetime="2021-03-23T14:44:28+08:00">2021-03-23</time>
              </span>
            
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Tech/" itemprop="url" rel="index"><span itemprop="name">Tech</span></a></span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Tech/Game-Dev/" itemprop="url" rel="index"><span itemprop="name">Game Dev</span></a></span>

                
                
              
            </span>
          

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>在Unity的所有免费资源里，如果只能推荐一个，那么我一定是毫不犹豫地选Fungus，这是一个超级无敌棒的插件，而且居然是免费开源的。<br>Fungus的主要功能是做剧情对话，如果是做传统的2D AVG游戏，这个插件基本上能够完成所有你需要的功能，比某些流氓软件功能多几倍还不会觊觎你作品的版权，当然，2D AVG的开源引擎其实比较多，除了Fungus以外，比较火的还有Ren’py、Twine等等，而后两者在写自定义插件时分别用的python和前端三件套语言比起Fungus需要的c#或者Lua还用得更广泛一点，但我更推荐Fungus的原因，是因为它在3D游戏中也有非常不错的应用空间，尤其如果你需要做一个重剧情轻任务的3D游戏时。</p>
<h4 id="哪些情况适合用Fungus"><a href="#哪些情况适合用Fungus" class="headerlink" title="哪些情况适合用Fungus"></a>哪些情况适合用Fungus</h4><p>1.2D的AVG游戏，这是Fungus最初也最本质的定位，自身功能非常强大，基本我能想到的传统2D AVG游戏里可能有的功能它都有直接提供，不需要自己额外写插件，非常适合擅长美术和编剧但编程苦手的人群，只要没有特别独特的需求，甚至可以零编程实现。而如果有特殊需求，也可以用Fungus来作为最基本的框架，然后对特殊需求部分自己写插件作为补充。</p>
<p>2.3D游戏中的剧情对话系统。Fungus支持Unity的3D碰撞检测，所以可以利用这个来做剧情触发，而Fungus的分支选项菜单、变量设置和条件触发、以及多样的文字呈现方式，基本能满足剧情对话的需要，而这样的功能如果完全自己来做，会多出几百行代码以及大量debug的工作量，而用Fungus的话，就只需要把自带的丑出天际且不适合3D的UI改一下就好。而且最棒的是，结合Unity的EventSystem和自定义c#脚本插件，你能用它做更多的事情，这个后面细讲。</p>
<p>3.Fungus不适用于做任务系统，因为它没有物品清单系统，如果只涉及到很少的物品，可以用里面的变量功能来实现，当然如果涉及物品多且复杂，也可以自己写插件添加进去，但这样就没必要用Fungus了，选一个任务类插件然后自己再在它的基础上修改更省力。</p>
<h4 id="Fungus使用Tips"><a href="#Fungus使用Tips" class="headerlink" title="Fungus使用Tips"></a>Fungus使用Tips</h4><h5 id="1-有必要一看的资源："><a href="#1-有必要一看的资源：" class="headerlink" title="1.有必要一看的资源："></a>1.有必要一看的资源：</h5><p>1.1.Fungus的包安装好后会发现它自带有一套example scene，可以挨个运行一下方便看都有哪些基本功能。<br>1.2.Fungus的<a href="https://github.com/snozbot/fungus/wiki/tutorial_videos" target="_blank" rel="noopener">官方指导视频</a>，B站有较完整的<a href="https://www.bilibili.com/video/BV1Tx411z7hz" target="_blank" rel="noopener">英字搬运</a>和不太完整的<a href="https://www.bilibili.com/video/BV1Fx411i7Y1" target="_blank" rel="noopener">中字搬运</a>。<br>1.3.Fungus的<a href="https://github.com/snozbot/fungus/wiki" target="_blank" rel="noopener">官方文档</a>，<br>1.4.Fungus的非官方教程不多，质量高的更少，至少在没科学上网的情况下是这样，对我有帮助的主要就<a href="https://www.bilibili.com/video/BV1Eb411P787" target="_blank" rel="noopener">这一个</a>。吐槽一下有些做教程的up主一定自己压根就不大用Fungus，按他的代码在他视频的场景里没问题，但只要他在场景里放第二个物体设第二个触发对话的trigger马上就会发现出bug，如果是刚接触Fungus和Unity的新人能给带沟里去。<br>1.5.Fungus的<a href="https://fungusgames.com/forum" target="_blank" rel="noopener">交流论坛入口</a>，第一个进不去了，第二三个可以。</p>
<p>其中，<br>1.1和1.2建议在使用前看，可以二选一看就行了。<br>1.3和1.4建议在看了1.1或者1.2或者使用中遇到问题时再看，因为在对基本功能没有概念的时候，看它们会有点太抽象不知道在说什么，但如果对基本功能有概念后，尤其在带着使用中的问题时，看起来的收获就会比较大。<br>强烈建议在用了一段时间后拉通看一遍1.3，会发现好些用了很久但一直没发现但非常实用的功能，哪怕1.1和1.2都可以不看直接摸索着用，但1.3真的值得花一个下午通拉过去。要说它有什么不足之处，主要是Fungus一直在更新，但文档并非所有地方都同步更新，但可以通过对照其它章节来补足。比如在Document-Home-Blocks-Setting an Event Handler中，列举的触发对话的方式是非常古早的，后面更新的而且我们经常常用的触发对话方式都没有写进去，但在Document-EventHandlers页面中就分类列举了所有触发方式。<br>1.5适合在使用一段时间后遇到无法解决的问题时使用，我目前为止还没用过，但看到上面Fungus制作团队和一些热心使用者会回答问题，其中制作团队直到本月依然有活跃答疑。</p>
<h5 id="2-Fungus在3D游戏中使用的注意事项："><a href="#2-Fungus在3D游戏中使用的注意事项：" class="headerlink" title="2.Fungus在3D游戏中使用的注意事项："></a>2.Fungus在3D游戏中使用的注意事项：</h5><p>想主要说一说3D，一是因为官方资源里基本是2D相关的，而3D的比较少；二是因为我自己主要是做3D的，在3D上踩过的坑和想到的点比较多。<br>1里列举的资料里有提到的就不赘述了，这里主要列一些实际使用中容易踩坑的地方和一些个人使用经验。</p>
<p><strong>2.1.碰撞检测与触发对话的相关：</strong></p>
<p>2.1.1.需要把flowchart作为组件挂在主控角色这个物体上，才能触发各种碰撞检测。千万不要直接tools-fungus-creat-flowchart，然后你会发现怎么都触发不了对话呢。<br>2.1.2.尽可能用trigger而不是collider来触发对话，这个主要是unity的锅，无论是fungus还是自制ui或者别的什么，collider平均3次里能成功触发1次就不错了，而trigger则很少bug。<br>2.1.3.一定一定要在trigger上设置tag，需要格外注意的是，不同的挂了trigger的物体，无论名字再八竿子打不着，距离多十万八千里，只要tag一样，那么触发一个就会导致所有的全被触发，所以，除非是打算几个物体触发任何一个都触发相同剧情，否则tag一定要分开，具体来说，不同叙事方法对tag的用法不同，这个在2.2里详细讲。</p>
<p><strong>2.2.不同叙事逻辑的实现技巧：</strong></p>
<p>2.2.1.线性叙事：一个tag即可，用好set active是关键。<br>在scene的hierarchy中，对所有的剧情触发物体，只有第一个设置为active，其它全都不勾选。然后在flowchart中，对于第一段剧情的block触发方式设定为trigger enter，触发后先把当前这个触发物体的set active给变成否，然后剧情走完后把第二个剧情触发点的物体给set active，接下来会按顺序进行到的每一个剧情触发点都以此类推，触发后把当前物品取消激活，同时给下一个触发点激活，直到最后一个剧情触发点。</p>
<p>2.2.2.主线-支线叙事：一条线一个tag，结合set active和variable来实现。<br>主线所有涉及到的触发点都共用一个tag就可以了，结合set active，按前面2.2.1的方法来实现。同时，对每一条支线需要设置一个tag和一个variable。<br>对所有variables的默认值都设为0，在主线进行到某个阶段可以触发某条支线剧情时，在主线的block里set variable设置支线甲int=1，然后在触发支线剧情的触发物体那里，除了用这条支线的特定tag去触发以外，还需满足if 支线甲int==1，这样就可以避免在主线没发展到可以接支线任务的时候就被提前触发了。支线任务如果有多段触发点，且多段出发点也是线性的，那么也可以结合set active来挨个激活每一个触发点，以保证每次是在正确的地方只触发下面一步的剧情。然后用同样的方法处理支线乙支线丙支线丁等等。</p>
<p>2.2.3.开放世界叙事：归类tag池，综合应用set active、variable、text variation。<br>因为不知道玩家会先去触发哪个，所以原则上来说，每一个线头都需要一个独立的tag，线头可能是一段持续好几个触发点的剧情，这个用前面2.2.1的方法结合set active来做就可以了，涉及到必须先触发这个线头并且走到哪一步，才有可能触发到那个线头的，用前面2.2.2的方法综合set active和variables来做，第三种线头是那种同类事物，接触任何一个都可能开展类似的对话，并且也许接触第一次第二次第N次触发的对话不一样的，这种共用一个tag，并且全部set active，用text variation来实现。对那种遇到第几次对话不一样而且有特定顺序的，用<code>[1|2|3|...|n]</code>，对那种遇到任何一个都随机从一个对话池里选其中一句出来的，用<code>[~1|2|3|...|n]</code>。</p>
<p><strong>2.3.结合Unity引擎的自身组件实现更多功能</strong></p>
<p>2.3.1.前面提到过Fungus里有set active这个命令，也就是激活某个在hierarchy里处于未激活状态的物体，那么靠这个我们可以让Fungus里的剧情发展到某个地方时，激活某个特定的物体，这样直接实现某些功能，前面已经举出过例子了，不赘诉。<br>2.3.2.类似的功能还有spawn object以及destroy，前者可以利用它来生成一些hierarchy里没有但有预制在prefab里的物体，比如刷出小怪或者刷出资源等等；后者则是相反，销毁在hierarchy里现存的物品。<br>2.3.3.除此之外的大头是Invoke命令，可以直接对接调用Unity的Event System，实现里面所自带的或者自己写了挂上去的c#脚本所附加给它的特殊功能，这样让Fungus可以实现的功能边界一下扩展开了。<br>2.3.4.另外一个大头是UI命令，可以直接对接调用Unity的原生UI系统，这样一方面可以解决一些显示问题，比如根据剧情分支不同，某个游戏物体上的字显示不同，就可以通过这个来实现；另一方面也可以结合前面的Invoke命令结合Event System来实现菜单问题，比如把Fungus里的语言选项或者音量调节选项给集成到主菜单的UI按钮或拉杆里去。</p>

        
      
    </div>

    
    
    
      <footer class="post-footer">
          <div class="post-eof"></div>
        
      </footer>
  </div>
  
  
  
  </article>

       
    
      
    
      
    
       
        <article itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block home">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/03/11/review-game-design-and-development-courses-updating/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Brielley">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Brielley">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
            
            <a href="/2020/03/11/review-game-design-and-development-courses-updating/" class="post-title-link" itemprop="url">Online Courses about Game Design and Development</a>
          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              
                
              

              <time title="Created: 2020-03-11 01:15:38" itemprop="dateCreated datePublished" datetime="2020-03-11T01:15:38+08:00">2020-03-11</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2021-03-23 14:49:19" itemprop="dateModified" datetime="2021-03-23T14:49:19+08:00">2021-03-23</time>
              </span>
            
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Tech/" itemprop="url" rel="index"><span itemprop="name">Tech</span></a></span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Tech/Study-Notes/" itemprop="url" rel="index"><span itemprop="name">Study Notes</span></a></span>

                
                
              
            </span>
          

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h4 id="游戏设计导论"><a href="#游戏设计导论" class="headerlink" title="游戏设计导论"></a><a href="https://www.coursera.org/learn/game-design/home/welcome" target="_blank" rel="noopener">游戏设计导论</a></h4><p>推荐度：★★★☆<br>授课方：加州艺术学院<br>平台：Coursera<br>费用：听课免费，证书收费但可申请全额助学金<br>语言：英语<br>字幕：中字 </p>
<p>Repo：最零基础上手的游戏设计课程。<br>不同于许多别的在讲游戏设计之前得先讲好几个小时的如何使用某个游戏引擎来呈现你的设计的课程，这个课不需要任何意义上的前置技能，会用纸笔就行了。<br>特点是别说那么多就是干。课程的构架基本上是你先随便设计一个游戏，然后我们一起看看它是不是有点不那么耐玩，来加点什么东西进去，看看迭代以后的是不是好玩一点了，但还不够，我们一起看看最好再加点什么东西进去，现在是不是更好玩一点了，重复以上过程。<br>于是这门课基本上没有什么授课内容，更像我们小时候的兴趣课，每周讲十分钟，然后用十小时来做自己的游戏、改自己的游戏、看别人的游戏。btw，虽然课程只要求看三个别人的游戏就可以了，但多看没限制，墙裂推荐多看看，我上的时候深觉这门课讲课是赠品做东西是前戏看别人的东西才是本体2333<br>这门课的不足之处也很明显，一是课程上让做的项目是桌游，而且是能简化到一页纸上的桌游，于是如果不是本身想做大富翁之类的游戏话可能直接的收获不大，更多的是收获管它做成啥样总之先行动起来的心态，以及迭代式开发的习惯；二是虽然整门课都在讲怎么提高游戏的游戏性，但讲授的方式更接近于直接丢出一堆公式去让人去套，对于为什么公式是这么写的如果我的情况不适合套公式有什么办法自己改公式或者造公式吗则没有涉及。</p>
<h4 id="游戏化"><a href="#游戏化" class="headerlink" title="游戏化"></a><a href="https://www.coursera.org/learn/gamification/home/welcome" target="_blank" rel="noopener">游戏化</a></h4><p>推荐度：★★★★☆<br>授课方：宾夕法尼亚大学<br>平台：Coursera<br>费用：听课免费，证书收费但可申请全额助学金<br>语言：英语<br>字幕：中字</p>
<p>Repo：对游戏为什么好玩怎么设计才能让游戏好玩让人想玩讲得最深入的课程。<br>虽然这其实并不是一门讲游戏设计的课程，但确是我上过的所有课程中，对于如何让游戏好玩分析得最深入的。一般课程对这个问题的回答都是要么集中在游戏叙事和游戏机制的技术细节和经验技巧上，要么提一嘴根源是不断的落在玩家心流区域的正反馈，但为什么是正反馈，是什么样的正反馈，则少有课程去触及。而这门课从心理学角度去继续往下挖并提出这根源于人的motivation，处于刚刚超过人当前能力上方一点点的任务被完成的正反馈，会让人的competence（能力感，觉得自己有能力克服障碍解决问题）得到满足，这是人的三大intrinsic motivation（内生驱动力，不依赖于外物刺激仅仅源于内心意愿驱动）之一，而除此之外，人的另两个主要的内生驱动力autonomy（自主感，觉得自己是完全出于自我意志作出有意义的选择）和relatedness（归属感，觉得自身的行为让自己与某些外在的具体事物或超越的抽象概念产生了连结）也与游戏好玩与否密切相关，是游戏设计需要核心注意的内容。而在设计中，对于extrinsic motivation（外生驱动力，外在奖励刺激）这把双刃剑则应谨慎使用，用得好的情况下，外生驱动力能够在内生驱动力不足的情况下提供有效的补充让游戏变得更好玩，但如果用得不好，则会掉入替代效应的陷阱——原本玩家是出于内生动力热爱一件事物，但由于提供了外生奖励，于是人们反而变得依赖于外生奖励才能激发动力，内生的热爱被挤占消失了。原则上来说，外生驱动力的四种形式external regulation（外在调节，内心厌恶完全因为外在的强迫而不得不做）、introjection（摄入调节，尽管自己不喜欢也不认同但考虑到他人会因自己做这件事而认同自己因此选择做）、identifucation（认同调节，尽管不喜欢但认同这件事的一些部分是有意义的因此认为自己应该做）、integration（整合调节，完全认可这整件事的意义和价值觉得自己必须做只是不能从做这件事中获得乐趣于是感到很难坚持），越往后的形式越接近于内生动力，越往前越接近于无动力（amotivation），在设计的时候如果需要外生动力作为补充，最好选择尽可能靠后的形式。这个理论是在课程的第三周讲的，目前为止我没有看到比它更好用的理论，墙裂安利即使没有时间上完整门课，第三周这俩小时的课程视频也绝对值得一看。<br>这门课的不足之处几乎恰好是前面加州艺术学院那门课的相反面，这是一门讲如何运用游戏机制设计产品或者项目管理的商科课，也因此有着绝大部分商科课最典型的毛病——分析了又分析挖掘了又挖掘但绝不撸袖子去做东西。这门课有三个作业，一个比一个要求的字数多，但始终不见让学生自己做方案，最后的两千词大作业也只让写出你认为在设计给定要求的方案时需要注意什么，而不是把方案本身写出来……所以如果不是想练英文写作，而是想学游戏设计，这门课本身的作业并没有太大帮助，不如给自己布置个运用所学分析自己玩过的游戏或者设计的游戏的作业更实用。</p>
<h4 id="游戏产业概论"><a href="#游戏产业概论" class="headerlink" title="游戏产业概论"></a><a href="https://www.coursera.org/learn/youxi-chanye-gailun/home/welcome" target="_blank" rel="noopener">游戏产业概论</a></h4><p>推荐度：★<br>授课方：上海戏剧学院<br>平台：Coursera<br>费用：听课免费，证书收费但可申请全额助学金<br>语言：中文<br>字幕：中字</p>
<p>Repo：我上过的游戏相关课程中唯一没有任何收获的，不推荐。<br>其实课程框架还可以，把游戏本身、游戏行业、资本环境都囊括到了，虽然产学结合算是高等教育的一个基本要求，但能做到的国内高校课程确实不多，理论上应该会是个好课程苗子。但很遗憾的是，即使相关知识极为有限的我也能明显感觉到，主讲老师对这三个领域都不太了解，于是理想很美好但执行不下去，于是只好给框架半颗星。有一点值得肯定的是，这门课也是我上过的唯一一门主讲老师会在课程论坛里跟学生交流的一门网课，这样的精神值得半颗星，这也给了这门课进化的可能，不知道几年过去这门课有没有迭代出撑得起框架的内容来。</p>
<p><em>以上三门课上于2016年春夏，不排除三四年过去课程内容有修改目前内容已与repo不符的可能。</em></p>
<p><em>以下课程为最近半个月新上，repo内容即为当前内容</em></p>
<h4 id="游戏开发导论"><a href="#游戏开发导论" class="headerlink" title="游戏开发导论"></a><a href="https://www.coursera.org/learn/game-development/home/welcome" target="_blank" rel="noopener">游戏开发导论</a></h4><p>推荐度：★★★★☆<br>授课方：密歇根州立大学<br>平台：Coursera<br>费用：听课免费，证书收费但可申请全额助学金<br>语言：英语<br>字幕：部分中字</p>
<p>Repo：我上过的最系统的unity入门教程，如果时间有限只能选一个教程来学unity的话那就它吧。<br>课程设置的时长是四周，具体可以按自己进度调整，体测总共上下来需要大约25小时。第一周是装软件熟悉基本界面，第二周是用一个都不是游戏的例子来讲软件的基本功能和从新建一个空项目到做完打包输出适配指定平台的过程。第三周是从零做一个第三人称视角的3D小游戏的例子，所有功能的实现都是用unity自带组件。第四周是从零做一个第一人称视角的3D小游戏的例子，部分功能的实现需要写代码（但完全自己写代码的时候比较少大部分工作是当调包侠调用unity自己内置的一些组件和一些三方开源组件）。其中后两周的两个项目开着unity自己跟着做下来，虽然比较花时间，每个要花接近10小时，但超级值，上完之后会有一种自己会用这个软件了的错觉，当然很快真去自己做东西的时候会马上被打脸，但至少虽然做不出来但心里大概有点思路有几个方向，不至于像上课前那样完全两眼一抹黑。<br>虽然只扣了它半颗星，但这门课也有很多需要提高的地方，首先我一定要吐槽它用的素材实在太太太太太丑了，基本上都是开局unity里新建一个球就是主控角色，新建一个方块儿就是小怪，然后分别蒙上大红大绿的辣眼皮就开始讲课……尤其第二周讲的栗子甚至都还不是游戏，导致我差一点点就半途弃了，还好没有。虽然理论上我知道有时候随手用个方块圆球来演示是个省时省力的替代方式，在设计原型的时候也经常用到，但，如果……授课老师能在他第一周提供的那么多免费素材网站里去随便拖点不那么辣眼睛的素材来用就更好了。<br>另一个我觉得这门课或有不足的地方，是乐趣性不够高。部分原因可能是因为课程想要把软件的方方面面都讲到，于是在选例子的时候就拿这个为标准来选，于是除了第四周的栗子以外，另两个例子都并不是我们通常会玩到的游戏类型，于是乐趣性有不足。与它相反的是unity learn上的几个新手教程，基本上都是大家平时会玩到的rpg啊fps啊解密啊潜行啊roguelike啊，素材大部分也都美美哒，学的过程就愉快得多，当然，确实我也很明显的感觉到了unity learn的那几门课上下来都只学到一些很碎片的东西，脑子里缺少对unity能做什么不能做什么从头做一个游戏都需要做些什么的整体概念，而且很多东西知其然不知其所以然。最理想的是结合起来上就好了，但似乎有时候乐趣和全面不可得兼。我的感觉是，如果心中有明确的想要做的游戏的概念了，需要学unity来实现它，或者至少实现个demo或者原型，那就只上这门课就可以了。而如果还没有明确的概念，那就这个教程加unity learn上找点自己感兴趣的游戏类型的教程结合起来看，比较能兼顾学的效果和学的乐趣。</p>
<h4 id="游戏设计原理"><a href="#游戏设计原理" class="headerlink" title="游戏设计原理"></a><a href="https://www.coursera.org/learn/gamedesign?specialization=game-development" target="_blank" rel="noopener">游戏设计原理</a></h4><p>推荐度：★★★☆<br>授课方：密歇根州立大学<br>平台：Coursera<br>费用：听课免费，证书收费但可申请全额助学金<br>语言：英语<br>字幕：部分中字</p>
<p>Repo：感觉这门课的目标受众大概是有志从事商业游戏设计的海外党，但对非目标受众来说感觉水分比干货多。<br>这门课是前面那门课所属系列的第二门课程，因为有上门课的好印象加成，我对它期待值很高，但上下来感觉比上门课水得多，或者说我不是它的目标受众，于是接近半数的课程内容对我来说不太有价值。比如第一周整周都可以跳过，第二周只需要听游戏文档那小节就可以了，第三周虽然水分不少但干货也不少可以整个听听，第四周除了原型和测试外的俩小节都挺水的可以跳过。<br>但这门课尽管干货部分少，但干货部分确实对我来说有帮助和启发。一方面整体思路变清晰了，另一方面他偶尔的随口一句经常会让我发现自己之前可能想的有问题或者没有考虑到的地方。<br>不足之处首先是前面提到的需要精简一点去去水分，然后对里面的干货部分可以扩展开来多讲一讲，很多一句话带过的其实倒是对我比较有启发，如果能多深入讲一讲会挺好的。另外这门课有个与内容无关但对我来说体验很糟的地方，是它的音频。主讲人说话拖音比较重，而我听拖音一向跟听刮黑板一样浑身难受，一般遇到这种情况我的解决方法是开1.5倍速这样就听不到拖音了，但这个视频这么做会一卡一卡的更难受了，加上他发摩擦音的时候音频特别高，而他一句话里就要带一两个的口癖right更是一个拖音加一个摩擦音简直能把人逼疯，上完以后大松一口气，希望以后的课程不是他主讲了。</p>
<h4 id="游戏分析与评测"><a href="#游戏分析与评测" class="headerlink" title="游戏分析与评测"></a><a href="https://next.xuetangx.com/course/tencentgames00001002032/1515957" target="_blank" rel="noopener">游戏分析与评测</a></h4><p>推荐度：★★★★ （目前上完章5，总14章，不排除之后会更新评价）<br>授课方：腾讯<br>平台：学堂在线<br>费用：听课免费，证书收费<br>语言：中文<br>字幕：中字</p>
<p>Repo：我所有上过的国内课程中最好的，推荐。<br>目前上到第五章，除了第一章略水可以跳过以外，其它四章都很棒。这门课的结构是第二章讲对每一款游戏具体可以从哪些方面去分析它，然后第三章开始到第十四章每章分析一个游戏类型，按照这个类型的发展历史从早到晚，选出有代表性的作品去逐一分析，然后归纳出整个类型的核心特点和变化趋势。这种自下而上从微观到中观的分析思路对我来说比较亲切，虽然我个人更习惯自上而下从宏观到中观到微观的思路，但自上而下和自下而上可以结合验证。然后我要说这门课真的超有趣，除了能听到不少有趣的古早八卦，每章的主讲人们都是卖安利一把好手，才四个类别上下来我就吃了好多好多游戏的安利，to-play-list简直能一路排到明年。<br>不足之处的话就是太多地方浅尝辄止了，我刚觉得这个话题有意思结果就换话题了，虽然受限于课程时长大部分课程都这样，但一般会给出扩展阅读的资料清单，而这门课没有这么做。虽然我上的别的很多课给出的扩展阅读清单里的大部分我也没有兴趣去读，有些有兴趣读的下下来目录扫过去发现和我想像的内容偏差太大也就弃了，但也有少部分打开我新世界大门的，这门课如果能加上这个就好了。</p>
<h4 id="游戏心理学"><a href="#游戏心理学" class="headerlink" title="游戏心理学"></a><a href="https://gameinstitute.qq.com/course/detail/10005" target="_blank" rel="noopener">游戏心理学</a></h4><p>推荐度：★★<br>授课方：腾讯<br>平台：腾讯游戏学院<br>费用：听课免费，不提供证书<br>语言：中文<br>字幕：中字</p>
<p>Repo：题目很大内容其实不多就简单谈了谈心流的一门课。<br>对于把正反馈循环描述为一种魔法式的神秘过程的做法我个人不是特别认同。但这门课对我而言提供了一个很有启发的地方，即在探究心流所需要的一定难度的挑战上，把游戏的难度分为了思考难度和操作难度，然后把主流游戏画在了这个坐标轴中。<br>思考难度和操作难度这个分法有点像一个古早概念文和武，但我觉得其实更准确用来描述它们的应该是《思考快与慢》提出的大脑的两个系统，潜意识层面的条件反射系统和意识层面的思考系统。在玩OW的时候我想过这个问题，但没有深挖下去，在上这门课后又重新想起了这个话题，感觉应该找个时间详细想一想写一写。</p>
<h4 id="Creator-Kit-RPG"><a href="#Creator-Kit-RPG" class="headerlink" title="Creator Kit: RPG"></a><a href="https://learn.unity.com/project/creator-kit-rpg?language=en" target="_blank" rel="noopener">Creator Kit: RPG</a></h4><p>推荐度：★★★★<br>授课方：Unity<br>平台：Unity Learn<br>费用：听课免费，不提供证书<br>语言：英文</p>
<p>Repo：适合无游戏制作基础无编程基础的2D RPG游戏制作的入门教程。<br>非常新手友好的一门unity上手课程，不需要编程，涉及到需要实现的功能都预先写好脚本嵌入到组件了。对完全没有基础的人来说，也能一步步跟着做下来一个关卡。而且最大的优势是花的时间特别短，一个下午就能搞定，从游戏的角度来说就是反馈特别及时。<br>不足之处是涉及到的内容略少，对于RPG来说就涉及到对话和任务俩功能，很多RPG的内容都没有涉及到，对于它的标题来说显得不太名副其实。另外一方面对软件涉及到的也比较有限，上下来没法建立起整体概念，在另两个unity learn上的creator kit系列教程里也多少都有点这个问题。</p>
<h4 id="Creator-Kit-FPS"><a href="#Creator-Kit-FPS" class="headerlink" title="Creator Kit: FPS"></a><a href="https://learn.unity.com/project/creator-kit-fps?language=en" target="_blank" rel="noopener">Creator Kit: FPS</a></h4><p>推荐度：★★★★<br>授课方：Unity<br>平台：Unity Learn<br>费用：听课免费，不提供证书<br>语言：英文</p>
<p>Repo：适合无游戏制作基础无编程基础的3D FPS游戏制作的入门教程。<br>和前面的RPG Kit一样，是不需要编程的新手教程，也是可以很快上手用最多大半天就可以跟着做出一个关卡的那种快速反馈大份快落的教程。有和前面差不多的问题，对标题所说的游戏类型里的功能只简单涉及到很少一部分但并不全，比如作为FPS但没有任何涉及小怪的移动或者小怪的攻击等等小怪行为的功能。对于软件整体也只涉及到很少的部分，没法让人建立起对整体的概念。</p>
<h4 id="Creator-Kit-Beginner-Code"><a href="#Creator-Kit-Beginner-Code" class="headerlink" title="Creator Kit: Beginner Code"></a><a href="https://learn.unity.com/project/creator-kit-beginner-code?language=en" target="_blank" rel="noopener">Creator Kit: Beginner Code</a></h4><p>推荐度：★★★★<br>授课方：Unity<br>平台：Unity Learn<br>费用：听课免费，不提供证书<br>语言：英文</p>
<p>Repo：适合有一定游戏制作概念但无编程基础的编程入门教程。<br>和前面两个Creator Kit系列的教程不同，这个教程的内容不是让人用给到的素材和预写好的功能组件去自己做一个关卡，而是用给到的预写好的功能组件的代码去改吧改吧成自己的代码。之前密歇根州立的那门unity课在第四周提到了一个观念，说有代码基础分几种，初极就大概知道哪些东西能写出来哪些东西不能写出来，中级就大概能蒙出来别人代码的意思然后改吧改吧成自己的代码，高级才需要自己从零写代码，做美术代码基础只需要初极，做设计只需要中级就够用了。这个观点挺震惊我的，一是很理所当然地觉得应该全民有代码基础，二是有代码基础的绝大部分其实是有用代码的能力而不是有造代码的能力，这和我之前上的好些国内代码入门教程都是让人从造简单代码开始慢慢升级造复杂代码的思路是完全不一样的，而且不得不说这个思路比较实用。但那门课虽提了这个思路，课程里讲代码的时候还是从头写的，只是调包的活儿做得比较多。而这个unity learn的教程体现了一样的思路，而且内容也真的是从一个别人写好的代码出发，教人怎么去猜那些看不懂的代码里的关键要素，然后把关键要素改一改，去游戏里看看是不是猜对了，如果猜错了怎么一键还原继续猜，如果猜对了继续看需要改的东西是不是忒多了复制粘贴手动改要素太麻烦，是吧那看看怎么自定义个函数或者函数类，去让抄代码改要素的过程更省事儿诸如此类的手把手花式抄代码教学。</p>
<h4 id="2D-Roguelike"><a href="#2D-Roguelike" class="headerlink" title="2D Roguelike"></a><a href="https://learn.unity.com/project/2d-roguelike-tutorial?language=en" target="_blank" rel="noopener">2D Roguelike</a></h4><p>推荐度：     （目前上到视频5，总14视频，完成后再打推荐度）<br>授课方：Unity<br>平台：Unity Learn<br>费用：听课免费，不提供证书<br>语言：部分中译</p>
<p>Repo：深刻体会到为啥这是一个中级教程了……前面仨视频都觉得还挺新手友好的呀，然后就被第一个脚本卡住了……耗了3个小时在上面现在还是有几个地方没看明白。按说有地方没看明白也没事，用前面俩教程的办法，可以先照抄然后去游戏里改变量来蒙，但是……把脚本拖到gameobject上的时候报错了，提示在修好bug之前挂不上去，但vs里标出来的bug我都修了呀……不管了先睡觉，眼睛都快成二筒了……</p>
<p><em>以上是能给到相对完整Repo的教程，下面是半途弃了于是仅能提供不完整感想的教程，因没看完不打推荐度</em></p>
<h4 id="The-Explorer-3D-Game-Kit"><a href="#The-Explorer-3D-Game-Kit" class="headerlink" title="The Explorer: 3D Game Kit"></a><a href="https://learn.unity.com/project/3d-game-kit?language=en" target="_blank" rel="noopener">The Explorer: 3D Game Kit</a></h4><p>授课方：Unity<br>平台：Unity Learn<br>费用：听课免费，不提供证书<br>语言：英文</p>
<p>Repo：适合无游戏制作基础无编程基础的3D第三人称RPG游戏制作的入门教程，硬盘和硬件杀手预警。<br>理论上这应该是一个不错的教程，从给出的Demo来看，会涉及到剧情触发、武器获得、战斗系统、解密系统等等常见的3D游戏会用到的功能，而且全是预制好的组件不需要自己编程，在几个无编程Kit教程中，这应该是涉及功能最多的一个，而且都挺实用的。然而，我只开了个头连试玩都没玩通就弃了的原因是，太太太太太太太卡了。我玩OW也从来没卡过的游戏本，在试玩这个游戏教程的Sample Level的时候硬生生卡得一个动作要延迟好几秒跑位起来看到的角色位置和实际的角色位置十万八千里……或许以后如果有一天我入了个台式会重新过一遍它，但目前，我能想到的使用方式大概只有需要用到里面预置的某些功能时看看能不能抄到点代码。</p>
<h4 id="附1-近期准备上的课程"><a href="#附1-近期准备上的课程" class="headerlink" title="附1 近期准备上的课程"></a>附1 近期准备上的课程</h4><p><em>游戏是个大坑，目测以后还会遇到很多教程，这篇Repo会持续更新，先列一些近期准备上的教程</em></p>
<h5 id="Ruby’s-Adventure-2D-Beginner"><a href="#Ruby’s-Adventure-2D-Beginner" class="headerlink" title="Ruby’s Adventure: 2D Beginner"></a><a href="https://learn.unity.com/project/ruby-s-2d-rpg?language=en" target="_blank" rel="noopener">Ruby’s Adventure: 2D Beginner</a></h5><p>授课方：Unity<br>平台：Unity Learn<br>费用：听课免费，不提供证书<br>语言：英文</p>
<p>Repo：其实2D教程里我最早下的是这个，然后大致浏览了一下框架，感觉适合有点基础的而不是纯萌新，于是转投了前面那个真新手教程。</p>
<h5 id="John-Lemon’s-Haunted-Jaunt-3D-Beginner"><a href="#John-Lemon’s-Haunted-Jaunt-3D-Beginner" class="headerlink" title="John Lemon’s Haunted Jaunt: 3D Beginner"></a><a href="https://learn.unity.com/project/john-lemon-s-haunted-jaunt-3d-beginner-1" target="_blank" rel="noopener">John Lemon’s Haunted Jaunt: 3D Beginner</a></h5><p>授课方：Unity<br>平台：Unity Learn<br>费用：听课免费，不提供证书<br>语言：中译</p>
<p>Repo：这个是我最早下的3D教程，因为它的标题里有个Beginner，又是Unity Learn上唯一一篇有中字的，看框架也还挺系统。然后我在第二章卡住了，跳了二三章以后，在第五章又卡住了，于是醒悟这个Beginner应该是指有一定游戏制作基础的Unity新手，而不是游戏制作新手。</p>
<h4 id="附2-各平台使用Tips"><a href="#附2-各平台使用Tips" class="headerlink" title="附2 各平台使用Tips"></a>附2 各平台使用Tips</h4><p>1.学堂在线的视屏播放页面，在IE上无法播放显示，在Chrome上可以播放显示但页面各控件的位置会出错并互相遮挡，在Edge上可正常显示和播放。</p>
<p>2.Coursera的视频在国内大部分地区无法正常播放，解决方法和过去英文维基网站一样修改hosts就好。打开<code>C:\Windows\System32\drivers\etc\hosts</code>，在末尾粘贴如下语句并保存。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">52.84.246.90    d3c33hcgiwev3.cloudfront.net</span><br><span class="line">52.84.246.252    d3c33hcgiwev3.cloudfront.net</span><br><span class="line">52.84.246.144    d3c33hcgiwev3.cloudfront.net</span><br><span class="line">52.84.246.72    d3c33hcgiwev3.cloudfront.net</span><br><span class="line">52.84.246.106    d3c33hcgiwev3.cloudfront.net</span><br><span class="line">52.84.246.135    d3c33hcgiwev3.cloudfront.net</span><br><span class="line">52.84.246.114    d3c33hcgiwev3.cloudfront.net</span><br><span class="line">52.84.246.90    d3c33hcgiwev3.cloudfront.net</span><br><span class="line">52.84.246.227    d3c33hcgiwev3.cloudfront.net</span><br></pre></td></tr></table></figure>

<p>随后运行cmd，输入以下命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ipconfig/flushdns</span><br></pre></td></tr></table></figure>

<p>刷新浏览器，会发现视频可以播放了。</p>
<p>3.Unity的教程素材下载有个巨坑，即无论是跟着Unity Hub给出的教程下载流程走，还是新建项目然后在Unity软件里打开Unity Asset Store去下载导入教程素材包，都会导致电脑里除了知道自己保存了的那个项目文件以外，还分别在C盘的两个临时文件夹中有两个文件备份。如果是下载的以M论的2D包还好，如果下载的3D包尤其是那个2个多G的课程包，分分钟C盘缩水近10G。<br>解决方法是该手动删掉手动删掉，该手动挪D盘手动挪D盘。<br>一般来说，下载的原始素材包会是一个有Unity图标的<code>.unitypackage</code>文件，这个文件在<code>C:\Users\电脑用户名\AppData\Roaming\Unity\Asset Store-5.x</code>，文件名一般就是你下载的那个素材的名字。直接挪到其它盘备份吧，以后如果需要用的时候可以重复导入。<br>然后当在Unity hub的教程页面里打开下载的那个原始素材包的时候，会生成一个原始的项目文件，准确的说是文件夹，文件夹下面和自己手动保存的项目文件夹下面的目录是一致的，这个文件夹在<code>C:\Users\电脑用户名\AppData\Local\Temp</code>，并且，文件夹名是乱码，也就是说没法通过名称找到它，只能通过推断。推断方法是，先选日期，筛选出打开它那个日期的所有临时文件，然后看文件大小，找到和自己手动保存的项目文件大小差不多的乱码文件夹，点开看看是不是和自己手动保存的项目文件夹内容大体一致，是的话就它了，直接删掉吧。</p>

        
      
    </div>

    
    
    
      <footer class="post-footer">
          <div class="post-eof"></div>
        
      </footer>
  </div>
  
  
  
  </article>

       
    
       
        <article itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block home">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/03/03/notes-skill-blog-errors and solutions/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Brielley">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Brielley">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
            
            <a href="/2020/03/03/notes-skill-blog-errors and solutions/" class="post-title-link" itemprop="url">Solutions to Hexo Errors I</a>
          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              
                
              

              <time title="Created: 2020-03-03 00:23:23" itemprop="dateCreated datePublished" datetime="2020-03-03T00:23:23+08:00">2020-03-03</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2021-03-23 14:30:51" itemprop="dateModified" datetime="2021-03-23T14:30:51+08:00">2021-03-23</time>
              </span>
            
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Tech/" itemprop="url" rel="index"><span itemprop="name">Tech</span></a></span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Tech/Blog/" itemprop="url" rel="index"><span itemprop="name">Blog</span></a></span>

                
                
              
            </span>
          

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="环境变量配置错误"><a href="#环境变量配置错误" class="headerlink" title="环境变量配置错误"></a>环境变量配置错误</h3><p>问题原因：<br>通常来说在安装Nodejs和Hexo时，会自动进行环境变量配置。但有时系统未进行该配置，或在安装其它程序后，其它程序安装时对环境变量的自动配置覆盖了之前安装Hexo时的配置，导致path报错。</p>
<p>问题表现：<br>在使用<code>$ hexo g</code>等命令时报错，错误提示为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Erorr: Command not found</span><br></pre></td></tr></table></figure>

<p>问题解决：<br>手动配置环境变量，将Nodejs和Hexo加入环境变量，具体如下：</p>
<p>Nodejs:<br>找到<code>/nodejs</code>在c盘中的位置，一般是在<code>/program files</code>或<code>/program files(x86)</code>下，复制该文件夹路径，如<code>C:\Program Files\nodejs</code><br>打开<code>控制面板——系统和安全——系统——高级系统设置——高级——环境变量——系统变量——Path——编辑——新建</code>，如上面复制的<code>C:\Program Files\nodejs</code>路径不在<code>Path</code>列表中，则将以上粘贴到新建行。</p>
<p>Hexo:<br>同样，找到<code>\blog\hexo\node_modules\hexo\bin</code>在电脑中的位置，复制该文件夹路径，如<code>D:\BLOG\hexo\node_modules\hexo\bin</code>，复制到上面所示的<code>Path</code>处。</p>
<h3 id="本地服务器端口冲突"><a href="#本地服务器端口冲突" class="headerlink" title="本地服务器端口冲突"></a>本地服务器端口冲突</h3><p>问题原因：<br>Hexo博客默认使用的本地服务器端口为4000，但这个端口很容易被别的进程占用，导致无法使用<code>http://localhost:4000</code>进行博客的本地预览。</p>
<p>问题表现：<br>在使用<code>$ hexo s</code>时报错，错误提示为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Error: listen EADDRINUSE</span><br></pre></td></tr></table></figure>

<p>同时<code>http://localhost:4000</code>上看不到博客页面。</p>
<p>问题解决：<br>改在别的端口预览就好了，比如5000，在<code>$ hexo s</code>时使用如下语句：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server -p 5000</span><br></pre></td></tr></table></figure>

<p>然后浏览器打开<code>http://localhost:5000</code>进行本地预览即可。</p>
<h3 id="Nunjuck解析错误"><a href="#Nunjuck解析错误" class="headerlink" title="Nunjuck解析错误"></a>Nunjuck解析错误</h3><p>问题原因：<br>Hexo博客是使用Nunjucks来进行解析的，这会导致博文中的`{{ }}`或`{% %}`一类的字符与之冲突，从而无法生成html文件。</p>
<p>问题表现：<br>在使用<code>$ hexo g</code>时报错，错误提示为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Nunjucks Error: [Line xxx, Column xxx] unexpected token: &#125;&#125;</span><br></pre></td></tr></table></figure>

<p>问题解决：<br>在会冲突的字符前后，使用<code>raw</code>把字符包裹起来，避免解析时报错。具体使用方式如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% raw %&#125;需包裹的字符&#123;% endraw %&#125;</span><br></pre></td></tr></table></figure>

<p>需注意的是，如果不对<code>.md</code>的文件中的冲突字符进行上述包裹操作，即使<code>.md</code>文件并不放在<code>_posts</code>文件夹下，而是仅仅放在诸如<code>_drafts</code>等文件夹下，也无法正常使用<code>$ hexo g</code>命令。</p>

        
      
    </div>

    
    
    
      <footer class="post-footer">
          <div class="post-eof"></div>
        
      </footer>
  </div>
  
  
  
  </article>

       
    
      
    
      
    
       
        <article itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block home">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/10/notes-skill-database-mysql/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Brielley">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Brielley">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
            
            <a href="/2020/01/10/notes-skill-database-mysql/" class="post-title-link" itemprop="url">MySQL Study Notes</a>
          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              
                
              

              <time title="Created: 2020-01-10 15:14:00" itemprop="dateCreated datePublished" datetime="2020-01-10T15:14:00+08:00">2020-01-10</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2021-03-23 14:41:18" itemprop="dateModified" datetime="2021-03-23T14:41:18+08:00">2021-03-23</time>
              </span>
            
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Tech/" itemprop="url" rel="index"><span itemprop="name">Tech</span></a></span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Tech/Study-Notes/" itemprop="url" rel="index"><span itemprop="name">Study Notes</span></a></span>

                
                
              
            </span>
          

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h4 id="数据提取与分析"><a href="#数据提取与分析" class="headerlink" title="数据提取与分析"></a>数据提取与分析</h4><h5 id="问题1-前几"><a href="#问题1-前几" class="headerlink" title="问题1 前几"></a>问题1 前几</h5><p>【涉及知识点】<br>最值：单列最大<code>max(column)</code>，单列最小<code>min(column)</code>；多列最大<code>greatest(column1,column2)</code>，多列最小<code>least(column1,column2)</code>，注意greatest和least里不能有值为null否则会返回null<br>剔重：<code>distinct</code><br>排序：按某column列从小到大<code>order by column</code>，从大到小<code>order by column desc</code><br>选取：<code>limit m offset n</code> 取第n+1至n+1+(m-1)=n+m名<br>没有结果时返回null：嵌套一层，内层没有结果什么也不会返回，外层在内层没有结果的情况下会返回null，也可以外层用<code>ifnull</code>更直观</p>
<p>【例题】#176 <a href="https://leetcode.com/problems/second-highest-salary/" target="_blank" rel="noopener">Second Highest Salary</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">Write a SQL query to get the second highest salary from the Employee table.</span><br><span class="line"></span><br><span class="line">+----+--------+</span><br><span class="line">| Id | Salary |</span><br><span class="line">+----+--------+</span><br><span class="line">| 1  | 100    |</span><br><span class="line">| 2  | 200    |</span><br><span class="line">| 3  | 300    |</span><br><span class="line">+----+--------+</span><br><span class="line">For example, given the above Employee table, the query should <span class="built_in">return</span> 200 as the second highest salary. </span><br><span class="line">If there is no second highest salary, <span class="keyword">then</span> the query should <span class="built_in">return</span> null.</span><br><span class="line"></span><br><span class="line">+---------------------+</span><br><span class="line">| SecondHighestSalary |</span><br><span class="line">+---------------------+</span><br><span class="line">| 200                 |</span><br><span class="line">+---------------------+</span><br></pre></td></tr></table></figure>

<p>【解析】<br>两种思路：一种是从高到低排序，然后取第二个，这种是如果要取的不是第二，而是第五或者第八到十都会比较适用的；另一种是先求最高的，然后求小于最高的那个，这种方法只在求第二的时候好使。</p>
<p>第二种思路的核心函数是max，求次高的时候可以用&lt;，也可以用not in，分别如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select max(salary) as <span class="string">'SecondHighestSalary'</span></span><br><span class="line">from employee</span><br><span class="line"><span class="built_in">where</span> salary &lt; (select max(salary) from employee)</span><br></pre></td></tr></table></figure>

<p>或者</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select max(salary) as <span class="string">'SecondHighestSalary'</span></span><br><span class="line">from employee</span><br><span class="line"><span class="built_in">where</span> salary not <span class="keyword">in</span> (select max(salary) from employee)</span><br></pre></td></tr></table></figure>

<p>备注:<br>1）其中前者运行时间是473ms，后者是229ms，后者比前者要快一些，事实上，大部分时候用where in都会更快。<br>2）虽然有函数，但没有group by，所以用where而不是having。<br>3）不用group by是因为是算的所有salary的top2，而不是按照某标准比如部门分组后计算每一组的salary的top2。</p>
<p>第一种思路的核心语句是order by desc和limit offset，无取值时返回null可以嵌套一层select也可以用ifnull，分别如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">select </span><br><span class="line">   (</span><br><span class="line">    select distinct salary</span><br><span class="line">    from employee</span><br><span class="line">    order by salary desc</span><br><span class="line">    <span class="built_in">limit</span> 1 offset 1</span><br><span class="line">    )</span><br><span class="line">    as <span class="string">'SecondHighestSalary'</span></span><br></pre></td></tr></table></figure>

<p>或者</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">select ifnull(</span><br><span class="line">               (select distinct salary</span><br><span class="line">                from employee</span><br><span class="line">                order by salary desc</span><br><span class="line">                <span class="built_in">limit</span> 1 offset 1)</span><br><span class="line">               ,null</span><br><span class="line">              )  </span><br><span class="line">              as <span class="string">'SecondHighestSalary'</span></span><br></pre></td></tr></table></figure>

<p>备注：<br>1）其中前者运行时间是430ms，后者运行时间是181ms，后者更快。<br>2）嵌套的外层是<code>select () as XXX</code>, 而不是<code>select xxx as XXX from () as t</code>，因为如果是后者的话，可以看到它的结构和内层一样，在没有值的时候返回的还是<code>[]</code>而不是<code>[null]</code>。</p>
<p>【例题】#184 <a href="https://leetcode.com/problems/department-highest-salary/" target="_blank" rel="noopener">Department Highest Salary</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">The Employee table holds all employees. Every employee has an Id, a salary, </span><br><span class="line">and there is also a column <span class="keyword">for</span> the department Id.</span><br><span class="line"></span><br><span class="line">+----+-------+--------+--------------+</span><br><span class="line">| Id | Name  | Salary | DepartmentId |</span><br><span class="line">+----+-------+--------+--------------+</span><br><span class="line">| 1  | Joe   | 70000  | 1            |</span><br><span class="line">| 2  | Jim   | 90000  | 1            |</span><br><span class="line">| 3  | Henry | 80000  | 2            |</span><br><span class="line">| 4  | Sam   | 60000  | 2            |</span><br><span class="line">| 5  | Max   | 90000  | 1            |</span><br><span class="line">+----+-------+--------+--------------+</span><br><span class="line">The Department table holds all departments of the company.</span><br><span class="line"></span><br><span class="line">+----+----------+</span><br><span class="line">| Id | Name     |</span><br><span class="line">+----+----------+</span><br><span class="line">| 1  | IT       |</span><br><span class="line">| 2  | Sales    |</span><br><span class="line">+----+----------+</span><br><span class="line">Write a SQL query to find employees who have the highest salary <span class="keyword">in</span> each of the departments. </span><br><span class="line">For the above tables, your SQL query should <span class="built_in">return</span> the following rows (order of rows does not matter).</span><br><span class="line"></span><br><span class="line">+------------+----------+--------+</span><br><span class="line">| Department | Employee | Salary |</span><br><span class="line">+------------+----------+--------+</span><br><span class="line">| IT         | Max      | 90000  |</span><br><span class="line">| IT         | Jim      | 90000  |</span><br><span class="line">| Sales      | Henry    | 80000  |</span><br><span class="line">+------------+----------+--------+</span><br><span class="line">Explanation:</span><br><span class="line"></span><br><span class="line">Max and Jim both have the highest salary <span class="keyword">in</span> the IT department </span><br><span class="line">and Henry has the highest salary <span class="keyword">in</span> the Sales department.</span><br></pre></td></tr></table></figure>

<p>【解析】<br>由于需要把所有并列部门第一的信息全部罗列出来，因此不能简单地group by部门以后倒序排列然后limit 1，而是需要嵌套一层，选出所有数值等于前者的，具体如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">select d.name as <span class="string">'Department'</span>,</span><br><span class="line">       e.name as <span class="string">'Employee'</span>,</span><br><span class="line">       e.Salary</span><br><span class="line">from employee e</span><br><span class="line">join department d</span><br><span class="line">on d.id=e.departmentid</span><br><span class="line">join (select max(salary) as mxsalary, departmentid from employee group by departmentid) mx</span><br><span class="line">on mx.mxsalary=e.salary and mx.departmentid=e.departmentid</span><br></pre></td></tr></table></figure>

<p>【例题】#185 <a href="https://leetcode.com/problems/department-top-three-salaries/" target="_blank" rel="noopener">Department Top Three Salaries</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">The Employee table holds all employees. Every employee has an Id, </span><br><span class="line">and there is also a column <span class="keyword">for</span> the department Id.</span><br><span class="line"></span><br><span class="line">+----+-------+--------+--------------+</span><br><span class="line">| Id | Name  | Salary | DepartmentId |</span><br><span class="line">+----+-------+--------+--------------+</span><br><span class="line">| 1  | Joe   | 85000  | 1            |</span><br><span class="line">| 2  | Henry | 80000  | 2            |</span><br><span class="line">| 3  | Sam   | 60000  | 2            |</span><br><span class="line">| 4  | Max   | 90000  | 1            |</span><br><span class="line">| 5  | Janet | 69000  | 1            |</span><br><span class="line">| 6  | Randy | 85000  | 1            |</span><br><span class="line">| 7  | Will  | 70000  | 1            |</span><br><span class="line">+----+-------+--------+--------------+</span><br><span class="line">The Department table holds all departments of the company.</span><br><span class="line"></span><br><span class="line">+----+----------+</span><br><span class="line">| Id | Name     |</span><br><span class="line">+----+----------+</span><br><span class="line">| 1  | IT       |</span><br><span class="line">| 2  | Sales    |</span><br><span class="line">+----+----------+</span><br><span class="line">Write a SQL query to find employees who earn the top three salaries <span class="keyword">in</span> each of the department. </span><br><span class="line">For the above tables, your SQL query should <span class="built_in">return</span> the following rows (order of rows does not matter).</span><br><span class="line"></span><br><span class="line">+------------+----------+--------+</span><br><span class="line">| Department | Employee | Salary |</span><br><span class="line">+------------+----------+--------+</span><br><span class="line">| IT         | Max      | 90000  |</span><br><span class="line">| IT         | Randy    | 85000  |</span><br><span class="line">| IT         | Joe      | 85000  |</span><br><span class="line">| IT         | Will     | 70000  |</span><br><span class="line">| Sales      | Henry    | 80000  |</span><br><span class="line">| Sales      | Sam      | 60000  |</span><br><span class="line">+------------+----------+--------+</span><br><span class="line">Explanation:</span><br><span class="line"></span><br><span class="line">In IT department, Max earns the highest salary, both Randy and Joe earn the second highest salary, </span><br><span class="line">and Will earns the third highest salary. There are only two employees <span class="keyword">in</span> the Sales department, </span><br><span class="line">Henry earns the highest salary <span class="keyword">while</span> Sam earns the second highest salary.</span><br></pre></td></tr></table></figure>

<p>【解析】<br>由于需要把满足条件的都列出来，而其中有并列的，因此需要把employee自己并表对比。核心思路是，每类比自己小的最多只有3个。具体如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">select d.name as <span class="string">'Department'</span>,</span><br><span class="line">       e1.name as <span class="string">'Employee'</span>,</span><br><span class="line">       e1.Salary</span><br><span class="line">from employee e1</span><br><span class="line">join department d</span><br><span class="line">on e1.departmentid=d.id </span><br><span class="line">join employee e2</span><br><span class="line">on e1.departmentid=e2.departmentid </span><br><span class="line"><span class="built_in">where</span> e1.salary&lt;=e2.salary</span><br><span class="line">group by e1.id</span><br><span class="line">having count(distinct(e2.salary))&lt;=3</span><br></pre></td></tr></table></figure>

<p>注意:<br>group by的是id，而不是departmentid，这是因为e1和e2已经按照同departmentid来比较了，group by主要是为了后面的having count()，而不是为了区分部门。后面可以用e1.id或者e1.name，但不能用e2的id或name，也不能用departmentid或者salary。</p>
<h5 id="问题2-对比"><a href="#问题2-对比" class="headerlink" title="问题2 对比"></a>问题2 对比</h5><p>【涉及知识点】<br>核心思路：先拆表再并表，把表按照一个参数一个表拆为多个表，再对比或用join连接各表进行数值对比<br>并表：<code>select xxx from table1 join table2 join table3 on table1.column1=table2.column2 and table1.column3=table3.column4</code><br>拆表：<code>select xxx from table as t1, table as t2 where</code></p>
<p>【例题】#181 <a href="https://leetcode.com/problems/employees-earning-more-than-their-managers/solution/" target="_blank" rel="noopener">Employees Earning More Than Their Managers</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">The Employee table holds all employees including their managers. Every employee has an Id, </span><br><span class="line">and there is also a column <span class="keyword">for</span> the manager Id.</span><br><span class="line"></span><br><span class="line">+----+-------+--------+-----------+</span><br><span class="line">| Id | Name  | Salary | ManagerId |</span><br><span class="line">+----+-------+--------+-----------+</span><br><span class="line">| 1  | Joe   | 70000  | 3         |</span><br><span class="line">| 2  | Henry | 80000  | 4         |</span><br><span class="line">| 3  | Sam   | 60000  | NULL      |</span><br><span class="line">| 4  | Max   | 90000  | NULL      |</span><br><span class="line">+----+-------+--------+-----------+</span><br><span class="line">Given the Employee table, write a SQL query that finds out employees who earn more than their managers. </span><br><span class="line">For the above table, Joe is the only employee who earns more than his manager.</span><br><span class="line"></span><br><span class="line">+----------+</span><br><span class="line">| Employee |</span><br><span class="line">+----------+</span><br><span class="line">| Joe      |</span><br><span class="line">+----------+</span><br></pre></td></tr></table></figure>

<p>【解析】<br>两种思路，一种是两个表直接对比，一种是并表对比，后者比前者用得更多，因为这个例题是只有两个参数，如果参数多了，并表更直观。</p>
<p>第一种思路直接对比，核心语句是where，具体如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">select e1.name as <span class="string">'Employee'</span></span><br><span class="line">from employee as e1,</span><br><span class="line">     employee as e2</span><br><span class="line"><span class="built_in">where</span> e1.managerid = e2.id</span><br><span class="line">and e1.salary &gt; e2.salary</span><br></pre></td></tr></table></figure>

<p>这种方法的运算时间是881ms，但不太常用，更常用的还是第二种思路join。</p>
<p>第二种思路先拆表再并表，核心语句是join，具体如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">select e1.name as <span class="string">'Employee'</span></span><br><span class="line">from employee as e1</span><br><span class="line">left join employee as e2</span><br><span class="line">on e1.managerid=e2.id</span><br><span class="line"><span class="built_in">where</span> e1.salary &gt; e2.salary</span><br></pre></td></tr></table></figure>

<p>这种方法的运算时间是792ms，比较常用，先拆表再并表是一种sql基本思路。</p>
<p>【例题】#601 <a href="https://leetcode.com/problems/human-traffic-of-stadium/" target="_blank" rel="noopener">Human Traffic of Stadium</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">X city built a new stadium, each day many people visit it and the stats are saved as these columns: </span><br><span class="line">id, visit_date, people</span><br><span class="line"></span><br><span class="line">Please write a query to display the records <span class="built_in">which</span> have 3 or more consecutive rows </span><br><span class="line">and the amount of people more than 100(inclusive).</span><br><span class="line"></span><br><span class="line">For example, the table stadium:</span><br><span class="line">+------+------------+-----------+</span><br><span class="line">| id   | visit_date | people    |</span><br><span class="line">+------+------------+-----------+</span><br><span class="line">| 1    | 2017-01-01 | 10        |</span><br><span class="line">| 2    | 2017-01-02 | 109       |</span><br><span class="line">| 3    | 2017-01-03 | 150       |</span><br><span class="line">| 4    | 2017-01-04 | 99        |</span><br><span class="line">| 5    | 2017-01-05 | 145       |</span><br><span class="line">| 6    | 2017-01-06 | 1455      |</span><br><span class="line">| 7    | 2017-01-07 | 199       |</span><br><span class="line">| 8    | 2017-01-08 | 188       |</span><br><span class="line">+------+------------+-----------+</span><br><span class="line">For the sample data above, the output is:</span><br><span class="line"></span><br><span class="line">+------+------------+-----------+</span><br><span class="line">| id   | visit_date | people    |</span><br><span class="line">+------+------------+-----------+</span><br><span class="line">| 5    | 2017-01-05 | 145       |</span><br><span class="line">| 6    | 2017-01-06 | 1455      |</span><br><span class="line">| 7    | 2017-01-07 | 199       |</span><br><span class="line">| 8    | 2017-01-08 | 188       |</span><br><span class="line">+------+------------+-----------+</span><br><span class="line">Note:</span><br><span class="line">Each day only have one row record, and the dates are increasing with id increasing.</span><br></pre></td></tr></table></figure>

<p>【解析】<br>拆成3个表来对比即可，注意符合条件的id可能在连续3个100以上访问记录的第1/2/3个中的任何一个位置，需用or来连接条件，并用（）来表示优先级，具体如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">select distinct s1.*</span><br><span class="line">from stadium s1, stadium s2, stadium s3</span><br><span class="line"><span class="built_in">where</span> s1.people&gt;=100 and s2.people&gt;=100 and s3.people&gt;=100</span><br><span class="line">and ((s1.id+1=s2.id and s2.id+1=s3.id) </span><br><span class="line">     or </span><br><span class="line">     (s2.id+1=s1.id and s1.id+1=s3.id) </span><br><span class="line">     or </span><br><span class="line">     (s3.id+1=s2.id and s2.id+1=s1.id))</span><br><span class="line">order by id</span><br></pre></td></tr></table></figure>

<p>注意：由于很多id同时满足or连接的不同条件，因此<code>distinct</code>和<code>order by</code>是必须的。</p>
<h5 id="问题3-查重"><a href="#问题3-查重" class="headerlink" title="问题3 查重"></a>问题3 查重</h5><p>【涉及知识点】<br>分类：<code>group by</code><br>计数：<code>count()</code><br>先拆再比</p>
<p>【例题】#182 <a href="https://leetcode.com/problems/duplicate-emails/" target="_blank" rel="noopener">Duplicate Emails</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">Write a SQL query to find all duplicate emails <span class="keyword">in</span> a table named Person.</span><br><span class="line"></span><br><span class="line">+----+---------+</span><br><span class="line">| Id | Email   |</span><br><span class="line">+----+---------+</span><br><span class="line">| 1  | a@b.com |</span><br><span class="line">| 2  | c@d.com |</span><br><span class="line">| 3  | a@b.com |</span><br><span class="line">+----+---------+</span><br><span class="line">For example, your query should <span class="built_in">return</span> the following <span class="keyword">for</span> the above table:</span><br><span class="line"></span><br><span class="line">+---------+</span><br><span class="line">| Email   |</span><br><span class="line">+---------+</span><br><span class="line">| a@b.com |</span><br><span class="line">+---------+</span><br><span class="line">Note: All emails are <span class="keyword">in</span> lowercase.</span><br></pre></td></tr></table></figure>

<p>【解析】<br>两种思路，一种思路是转化为对比问题，用上面问题2对比中所用的先拆再比的办法，另一种思路是每个email分个类，选出分类计数大于1的。</p>
<p>第一种思路，拆成两个表，求那些id不同但email值相同的，具体如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">select distinct p1.Email</span><br><span class="line">from person p1,</span><br><span class="line">     person p2</span><br><span class="line"><span class="built_in">where</span> p1.id &lt;&gt; p2.id</span><br><span class="line">and p1.email = p2.email</span><br></pre></td></tr></table></figure>

<p>备注：<br>1）这种方法的运算速度是513ms<br>2）注意要用distinct，这样如果重复次数多于2次的时候，只会返回一个值。</p>
<p>另一种思路，按email进行分类，求类别下的id数大于1的，具体如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">select Email</span><br><span class="line">from person</span><br><span class="line">group by email</span><br><span class="line">having count(email) &gt; 1</span><br></pre></td></tr></table></figure>

<p>备注：<br>1）这种方法的运算速度是436ms<br>2）注意因为有分类<code>group by</code>，求每个类别的计数条件要用<code>having</code>，而不是求所有的计数所用的<code>where</code>。<br>3）计数这种方式比起前一种拆表对比的方式而言，适用性更强，在有多个参数有要求时更方便直观。</p>
<p>【例题】#596 <a href="https://leetcode.com/problems/classes-more-than-5-students/" target="_blank" rel="noopener">Classes More Than 5 Students</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">There is a table courses with columns: student and class</span><br><span class="line"></span><br><span class="line">Please list out all classes <span class="built_in">which</span> have more than or equal to 5 students.</span><br><span class="line"></span><br><span class="line">For example, the table:</span><br><span class="line"></span><br><span class="line">+---------+------------+</span><br><span class="line">| student | class      |</span><br><span class="line">+---------+------------+</span><br><span class="line">| A       | Math       |</span><br><span class="line">| B       | English    |</span><br><span class="line">| C       | Math       |</span><br><span class="line">| D       | Biology    |</span><br><span class="line">| E       | Math       |</span><br><span class="line">| F       | Computer   |</span><br><span class="line">| G       | Math       |</span><br><span class="line">| H       | Math       |</span><br><span class="line">| I       | Math       |</span><br><span class="line">+---------+------------+</span><br><span class="line">Should output:</span><br><span class="line"></span><br><span class="line">+---------+</span><br><span class="line">| class   |</span><br><span class="line">+---------+</span><br><span class="line">| Math    |</span><br><span class="line">+---------+</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Note:</span><br><span class="line">The students should not be counted duplicate <span class="keyword">in</span> each course.</span><br></pre></td></tr></table></figure>

<p>【解析】<br>这样计数超过2的情况用对比就不好使了，用group by再count则非常方便。具体如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">select class</span><br><span class="line">from courses</span><br><span class="line">group by class</span><br><span class="line">having count(distinct student)&gt;=5</span><br></pre></td></tr></table></figure>

<p>备注：<br>1）同上例，因为有<code>group by</code>，所以不能用<code>where</code>，而应该用<code>having</code>来求每组的数字<br>2）考虑到表中有可能有不同口径重复写入的情况，因此需要<code>distinct</code>剔除重复的记录，最好养成加distinct的习惯，因为如果没有重复记录，加一个distinct也不会影响结果。</p>
<h5 id="问题4-日期"><a href="#问题4-日期" class="headerlink" title="问题4 日期"></a>问题4 日期</h5><p>【涉及知识点】<br><strong>返回当前日期和时间</strong>：<br><code>now()</code>会返回当前YYYY-MM-DD HH:MM:SS，<br><code>curdate()</code>会返回当前YYYY-MM-DD，<br><code>curtime()</code>会返回当前HH:MM:SS<br><strong>截取时间中的某个值</strong>：<br><code>date(column)</code>会返回column中的YYYY-MM-DD，<br><code>extract(year/quarter/month/week/day/hour/minute/second/microsecond/hour_minute/day_minute/year_month from column)</code>会返回column中的YYYY/Q/MM/WW/DD/HH/MM/SS/MS/HHMM/DDHHMM/YYYYMM 注，Q是从1开始计，WW是在第一个周日前计为0，第一个周日开始到第一个周六计为1，以此类推<br><strong>增减求日期间隔</strong>：<br><code>date_add(date, interval 1 day/week/month/quarter/year/hour/minute/second)</code>返回date之后1天/周/月/季/年/小时/分钟/秒钟后的那个日期，<br><code>date_sub(date, interval 2 day/...)</code>返回date之前1天/…后的那个日期，<br><code>datediff(date1,date2)</code>返回两个日期中间的间隔<strong>天</strong>数。</p>
<p>【例题】#197 <a href="https://leetcode.com/problems/rising-temperature/" target="_blank" rel="noopener">Rising Temperature</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">Given a Weather table, write a SQL query to find all dates<span class="string">' Ids </span></span><br><span class="line"><span class="string">with higher temperature compared to its previous (yesterday'</span>s) dates.</span><br><span class="line"></span><br><span class="line">+---------+------------------+------------------+</span><br><span class="line">| Id(INT) | RecordDate(DATE) | Temperature(INT) |</span><br><span class="line">+---------+------------------+------------------+</span><br><span class="line">|       1 |       2015-01-01 |               10 |</span><br><span class="line">|       2 |       2015-01-02 |               25 |</span><br><span class="line">|       3 |       2015-01-03 |               20 |</span><br><span class="line">|       4 |       2015-01-04 |               30 |</span><br><span class="line">+---------+------------------+------------------+</span><br><span class="line">For example, <span class="built_in">return</span> the following Ids <span class="keyword">for</span> the above Weather table:</span><br><span class="line"></span><br><span class="line">+----+</span><br><span class="line">| Id |</span><br><span class="line">+----+</span><br><span class="line">|  2 |</span><br><span class="line">|  4 |</span><br><span class="line">+----+</span><br></pre></td></tr></table></figure>

<p>【解析】<br>主体是一个非常简单的先拆表再比较或并表，容易错的点在于：由于记录不一定是连续的，所以不能用id而应该用recorddate来表达previous dates的概念，用到<code>date_add</code>或<code>datediff</code>函数，具体如下：<br>date_add+拆表比较（运算时间1025ms）</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">select w2.Id </span><br><span class="line">from weather w1, </span><br><span class="line">     weather w2</span><br><span class="line"><span class="built_in">where</span> date_add(w1.recorddate, interval 1 day)=w2.recorddate </span><br><span class="line">and w1.temperature&lt;w2.temperature</span><br></pre></td></tr></table></figure>

<p>datediff+拆表比较（运算时间641ms）</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">select w2.Id </span><br><span class="line">from weather w1, </span><br><span class="line">     weather w2</span><br><span class="line"><span class="built_in">where</span> datediff(w1.recorddate, w2.recorddate)=-1 </span><br><span class="line">and w1.temperature&lt;w2.temperature</span><br></pre></td></tr></table></figure>

<p>date_add+拆表并表（运算时间679ms)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">select w2.Id </span><br><span class="line">from weather w1</span><br><span class="line">right join weather w2</span><br><span class="line">on date_add(w1.recorddate,interval 1 day)=w2.recorddate</span><br><span class="line"><span class="built_in">where</span> w1.temperature&lt;w2.temperature</span><br></pre></td></tr></table></figure>

<p>datediff+拆表并表（运算时间791ms）</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">select w2.Id </span><br><span class="line">from weather w1</span><br><span class="line">right join weather w2</span><br><span class="line">on datediff(w1.recorddate, w2.recorddate)=-1 </span><br><span class="line"><span class="built_in">where</span> w1.temperature&lt;w2.temperature</span><br></pre></td></tr></table></figure>

<p>从运算时间看，其中如果采用并表join，用date_add更快一点；如果采用比较，用datediff要快很多。<br>考虑到大部分情况下用join会比直接比较更适合多参数拆分为多表时，因此在date_add和datediff都能用的情况下可考虑优先选用date_add。</p>
<h5 id="问题5-数字"><a href="#问题5-数字" class="headerlink" title="问题5 数字"></a>问题5 数字</h5><p>【涉及知识点】<br><strong>一些常用符号</strong>：<br>不等于可以用<code>&lt;&gt;</code>也可以用<code>!=</code>；<br>余数可以用<code>mod(被除数,除数)=余数</code>也可以用<code>被除数%除数=余数</code>；<br><strong>截取数字</strong>：<br><code>round(3.1415, 3)</code>=3.142，<br><code>truncate(3.1415, 3)</code>=3.141，<br><code>floor(3.1415)</code>=3，<br><code>ceil(3.1415)</code>=4</p>
<p>【例题】#620 <a href="https://leetcode.com/problems/not-boring-movies/" target="_blank" rel="noopener">Not Boring Movies</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">X city opened a new cinema, many people would like to go to this cinema. </span><br><span class="line">The cinema also gives out a poster indicating the movies’ ratings and descriptions.</span><br><span class="line">Please write a SQL query to output movies with an odd numbered ID and a description </span><br><span class="line">that is not <span class="string">'boring'</span>. Order the result by rating.</span><br><span class="line"></span><br><span class="line">For example, table cinema:</span><br><span class="line"></span><br><span class="line">+---------+-----------+--------------+-----------+</span><br><span class="line">|   id    | movie     |  description |  rating   |</span><br><span class="line">+---------+-----------+--------------+-----------+</span><br><span class="line">|   1     | War       |   great 3D   |   8.9     |</span><br><span class="line">|   2     | Science   |   fiction    |   8.5     |</span><br><span class="line">|   3     | irish     |   boring     |   6.2     |</span><br><span class="line">|   4     | Ice song  |   Fantacy    |   8.6     |</span><br><span class="line">|   5     | House card|   Interesting|   9.1     |</span><br><span class="line">+---------+-----------+--------------+-----------+</span><br><span class="line">For the example above, the output should be:</span><br><span class="line">+---------+-----------+--------------+-----------+</span><br><span class="line">|   id    | movie     |  description |  rating   |</span><br><span class="line">+---------+-----------+--------------+-----------+</span><br><span class="line">|   5     | House card|   Interesting|   9.1     |</span><br><span class="line">|   1     | War       |   great 3D   |   8.9     |</span><br><span class="line">+---------+-----------+--------------+-----------+</span><br></pre></td></tr></table></figure>

<p>【解析】 这道题非常简单，仅需知道余数的表达方式即可，余数用<code>%</code>则只有mysql支持，用<code>mod()</code>则其它如oracle等也支持，这道题的description里的boring是精确的，可以直接用<code>=</code>，但考虑到大部分时候描述和评价会是一小段话而非一个词，因此用了字符串模糊匹配的<code>not like &#39;%xxx%&#39;</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">select * </span><br><span class="line">from cinema</span><br><span class="line"><span class="built_in">where</span> id%2=1</span><br><span class="line">and description not like <span class="string">'%boring%'</span></span><br><span class="line">order by rating desc</span><br></pre></td></tr></table></figure>

<h5 id="问题6-字符"><a href="#问题6-字符" class="headerlink" title="问题6 字符"></a>问题6 字符</h5><p>【涉及知识点】<br><strong>字符串匹配</strong>：<br>精确匹配用<code>=</code>，模糊匹配用<code>like</code>或<code>not like</code>，<br>模糊匹配不确定前后有多少字符的时候用<code>&#39;%word%&#39;</code>，模糊匹配确定前后有多少个字符的时候用<code>&#39;w_rd&#39;</code>，<br>模糊匹配多个可以包含的字符时用<code>&#39;where city like [ANL]%&#39;</code>，即返回所有以A或N或L字母打头的城市名，<br>模糊匹配多个需要排除的字符时用<code>&#39;where city like [!ANL]&#39;</code>，即返回所有<strong>不</strong>以A或N或L字母打头的城市名。<br><strong>字符串长度</strong>：<br><code>len(column)</code>，返回这列每个值的字符串长度<br><strong>字符串定位</strong>：<br><code>locate(abc, column)</code>，返回这列每个值中，字符abc出现的位置，如无返回0<br><strong>截取字符串</strong>：<br><code>mid(column, x, n)</code>，返回这列每个值中，从第x个字符开始一直截取n个字符的这一串子字符串</p>
<p>【例题】<br>问题5的例题262、问题11的例题620解析中有涉及到字符串处理，不赘述。</p>
<h5 id="问题7-替换"><a href="#问题7-替换" class="headerlink" title="问题7 替换"></a>问题7 替换</h5><p>【涉及知识点】<br>替换问题的核心其实是多条件赋值，如果只有较少条件的时候可以用<code>if()</code>，如果条件多时需要用<code>case when</code><br><strong>if的基本用法</strong>：<code>if(条件, 符合条件时的赋值1, 不符合条件时的赋值2)</code><br><strong>case when的基本用法</strong>：<code>case when 条件1 then 赋值1 when 条件2 then 赋值2 else 赋值3 end</code></p>
<p>【例题】#627 <a href="https://leetcode.com/problems/swap-salary/" target="_blank" rel="noopener">Swap Salary</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">Given a table salary, such as the one below, that has m=male and f=female values. </span><br><span class="line">Swap all f and m values (i.e., change all f values to m and vice versa) with a single update statement </span><br><span class="line">and no intermediate temp table.</span><br><span class="line"></span><br><span class="line">Note that you must write a single update statement, DO NOT write any select statement <span class="keyword">for</span> this problem.</span><br><span class="line"></span><br><span class="line">Example:</span><br><span class="line"></span><br><span class="line">| id | name | sex | salary |</span><br><span class="line">|----|------|-----|--------|</span><br><span class="line">| 1  | A    | m   | 2500   |</span><br><span class="line">| 2  | B    | f   | 1500   |</span><br><span class="line">| 3  | C    | m   | 5500   |</span><br><span class="line">| 4  | D    | f   | 500    |</span><br><span class="line"></span><br><span class="line">After running your update statement, the above salary table should have the following rows:</span><br><span class="line"></span><br><span class="line">| id | name | sex | salary |</span><br><span class="line">|----|------|-----|--------|</span><br><span class="line">| 1  | A    | f   | 2500   |</span><br><span class="line">| 2  | B    | m   | 1500   |</span><br><span class="line">| 3  | C    | f   | 5500   |</span><br><span class="line">| 4  | D    | m   | 500    |</span><br></pre></td></tr></table></figure>

<p>【解析】<br>解题思路有两种，一种是用if，因为这里只有两个赋值，一种是用更具普遍性的case when。<br>需要额外提到的是，这是一个更新数据库而非通常的提取数据用于分析的场景，需要用到<code>update</code>而非日常的select，更新数据update的基本用法是：<code>update 表格名 set 需修改参数列名 = 修改内容</code></p>
<p>第一种思路，case when，具体如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">update salary </span><br><span class="line"><span class="built_in">set</span> sex = <span class="keyword">case</span> sex when <span class="string">'f'</span> <span class="keyword">then</span> <span class="string">'m'</span></span><br><span class="line">                   <span class="keyword">else</span> <span class="string">'f'</span></span><br><span class="line">          end</span><br></pre></td></tr></table></figure>

<p>需要注意的是，修改的列和条件的列都是sex，如果不是同一列的话比如修改的是name，用于判断的条件是id，那么会写作<code>update salary set name= case id when 1 then &#39;aaa&#39; when 2 then &#39;bbb&#39; else &#39;ccc&#39; end</code><br>另，如果不写作case sex when，而是直接用case when，把sex放到后面去也是可以的，具体写作：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">update salary</span><br><span class="line"><span class="built_in">set</span> sex = <span class="keyword">case</span> when sex=<span class="string">'f'</span></span><br><span class="line">               <span class="keyword">then</span> <span class="string">'m'</span></span><br><span class="line">               <span class="keyword">else</span> <span class="string">'f'</span></span><br><span class="line">          end</span><br></pre></td></tr></table></figure>

<p>第二种思路，if，因为这里sex只有两个取值，所以用if是足够的，具体如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">update salary </span><br><span class="line"><span class="built_in">set</span> sex = <span class="keyword">if</span>(sex=<span class="string">'f'</span>,<span class="string">'m'</span>,<span class="string">'f'</span>)</span><br></pre></td></tr></table></figure>

<p>需要注意的是，if后面的条件必须完整的写为sex=xxx，而不能因为前面已经有sex=了就省掉，因为这里的条件和要赋值的列都是sex，但可能存在不是同一个列的情况，比如按照上面的栗子会写作<code>update salary set name = if(id=1,&#39;aaa&#39;,&#39;bbb&#39;)</code></p>
<p>这里用if的运算时间是518ms，用case when的运算时间是337ms，尽管if的代码要短一些，但case when的运算速度更快，考虑到case when的适用场景也更多，因此在替换与赋值问题中尽量优先选择使用case when。</p>
<p>【例题】#626 <a href="https://leetcode.com/problems/exchange-seats/" target="_blank" rel="noopener">Exchange Seats</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">Mary is a teacher <span class="keyword">in</span> a middle school and she has a table seat storing students<span class="string">' names </span></span><br><span class="line"><span class="string">and their corresponding seat ids.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">The column id is continuous increment.</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">Mary wants to change seats for the adjacent students.</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">Can you write a SQL query to output the result for Mary?</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">+---------+---------+</span></span><br><span class="line"><span class="string">|    id   | student |</span></span><br><span class="line"><span class="string">+---------+---------+</span></span><br><span class="line"><span class="string">|    1    | Abbot   |</span></span><br><span class="line"><span class="string">|    2    | Doris   |</span></span><br><span class="line"><span class="string">|    3    | Emerson |</span></span><br><span class="line"><span class="string">|    4    | Green   |</span></span><br><span class="line"><span class="string">|    5    | Jeames  |</span></span><br><span class="line"><span class="string">+---------+---------+</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">For the sample input, the output is:</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">+---------+---------+</span></span><br><span class="line"><span class="string">|    id   | student |</span></span><br><span class="line"><span class="string">+---------+---------+</span></span><br><span class="line"><span class="string">|    1    | Doris   |</span></span><br><span class="line"><span class="string">|    2    | Abbot   |</span></span><br><span class="line"><span class="string">|    3    | Green   |</span></span><br><span class="line"><span class="string">|    4    | Emerson |</span></span><br><span class="line"><span class="string">|    5    | Jeames  |</span></span><br><span class="line"><span class="string">+---------+---------+</span></span><br><span class="line"><span class="string">Note:</span></span><br><span class="line"><span class="string">If the number of students is odd, there is no need to change the last one'</span>s seat.</span><br></pre></td></tr></table></figure>

<p>【解析】<br>由于涉及到3个情景：奇数且不为最大值，奇数且为最大值，偶数。因此无法用if，需用case when，具体如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">select </span><br><span class="line">      (<span class="keyword">case</span> when id%2=0 <span class="keyword">then</span> id-1</span><br><span class="line">            when id%2=1 and id&lt;&gt;maxid <span class="keyword">then</span> id+1</span><br><span class="line">            <span class="keyword">else</span> id</span><br><span class="line">       end</span><br><span class="line">       ) as id,</span><br><span class="line">       student</span><br><span class="line">from seat,</span><br><span class="line">     (select max(id) as maxid from seat) mx</span><br><span class="line">order by id</span><br></pre></td></tr></table></figure>

<p>注意：<br>不能在case when的其中一个枝干里直接用<code>case when id%2=1 and id not in (select max(id) from seat) mx then id+1</code>，而须按照上面的写法把mx放到from之后，否则会报错。</p>
<h5 id="问题8-扩表"><a href="#问题8-扩表" class="headerlink" title="问题8 扩表"></a>问题8 扩表</h5><p>【涉及知识点】<br>扩表是把记录不连续的表格扩大成包含一系列参数的大表，通常包含两类操作：列转行或行转列、对无记录的条目进行赋值<br>列转行通常有三种做法：<code>if</code>；<code>case when</code>；<code>pivot</code><br>行转列通常做法为：<code>union</code>/<code>union all</code><br>if和case when的用法在问题7替换中已经讲过了，不赘述。<br>pivot的基本用法：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select column2value1,column2value2,column2value3</span><br><span class="line">from (select * from originaltable) as base</span><br><span class="line">pivot(max/min/sum(column1) <span class="keyword">for</span> column2 <span class="keyword">in</span> (column2value1,column2value2,column2value3)) as pvt</span><br></pre></td></tr></table></figure>

<p>union /union all基本用法：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select column from table</span><br><span class="line">union (all)</span><br><span class="line">select column from table</span><br></pre></td></tr></table></figure>

<p>需注意的是，1）如果用union会自动剃重，union all则不会 2）被连接各表的colomn项目顺序格式必须完全一样 3）union除了用作行转列外，也可用作纵向并表（join为横向并表）</p>
<p>【例题】#1179 <a href="https://leetcode.com/problems/reformat-department-table/" target="_blank" rel="noopener">Reformat Department Table</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">Table: Department</span><br><span class="line"></span><br><span class="line">+---------------+---------+</span><br><span class="line">| Column Name   | Type    |</span><br><span class="line">+---------------+---------+</span><br><span class="line">| id            | int     |</span><br><span class="line">| revenue       | int     |</span><br><span class="line">| month         | varchar |</span><br><span class="line">+---------------+---------+</span><br><span class="line">(id, month) is the primary key of this table.</span><br><span class="line">The table has information about the revenue of each department per month.</span><br><span class="line">The month has values <span class="keyword">in</span> [<span class="string">"Jan"</span>,<span class="string">"Feb"</span>,<span class="string">"Mar"</span>,<span class="string">"Apr"</span>,<span class="string">"May"</span>,<span class="string">"Jun"</span>,<span class="string">"Jul"</span>,<span class="string">"Aug"</span>,<span class="string">"Sep"</span>,<span class="string">"Oct"</span>,<span class="string">"Nov"</span>,<span class="string">"Dec"</span>].</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">Write an SQL query to reformat the table such that there is a department id column </span><br><span class="line">and a revenue column <span class="keyword">for</span> each month.</span><br><span class="line"></span><br><span class="line">The query result format is <span class="keyword">in</span> the following example:</span><br><span class="line"></span><br><span class="line">Department table:</span><br><span class="line">+------+---------+-------+</span><br><span class="line">| id   | revenue | month |</span><br><span class="line">+------+---------+-------+</span><br><span class="line">| 1    | 8000    | Jan   |</span><br><span class="line">| 2    | 9000    | Jan   |</span><br><span class="line">| 3    | 10000   | Feb   |</span><br><span class="line">| 1    | 7000    | Feb   |</span><br><span class="line">| 1    | 6000    | Mar   |</span><br><span class="line">+------+---------+-------+</span><br><span class="line"></span><br><span class="line">Result table:</span><br><span class="line">+------+-------------+-------------+-------------+-----+-------------+</span><br><span class="line">| id   | Jan_Revenue | Feb_Revenue | Mar_Revenue | ... | Dec_Revenue |</span><br><span class="line">+------+-------------+-------------+-------------+-----+-------------+</span><br><span class="line">| 1    | 8000        | 7000        | 6000        | ... | null        |</span><br><span class="line">| 2    | 9000        | null        | null        | ... | null        |</span><br><span class="line">| 3    | null        | 10000       | null        | ... | null        |</span><br><span class="line">+------+-------------+-------------+-------------+-----+-------------+</span><br><span class="line"></span><br><span class="line">Note that the result table has 13 columns (1 <span class="keyword">for</span> the department id + 12 <span class="keyword">for</span> the months).</span><br></pre></td></tr></table></figure>

<p>【解析】<br>这是一个典型的扩表问题，需要的工作包含列转行和对没有记录的取值赋值为null，下面分别用case when；if；pivot来实现。<br>第一种方法，case when，具体如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">select distinct id,</span><br><span class="line">       sum(CASE when month=<span class="string">'jan'</span> <span class="keyword">then</span> revenue <span class="keyword">else</span> null END) as <span class="string">'Jan_Revenue'</span>,</span><br><span class="line">       sum(CASE when month=<span class="string">'feb'</span> <span class="keyword">then</span> revenue <span class="keyword">else</span> null END) as <span class="string">'Feb_Revenue'</span>,</span><br><span class="line">       sum(CASE when month=<span class="string">'mar'</span> <span class="keyword">then</span> revenue <span class="keyword">else</span> null END) as <span class="string">'Mar_Revenue'</span>,</span><br><span class="line">       sum(CASE when month=<span class="string">'apr'</span> <span class="keyword">then</span> revenue <span class="keyword">else</span> null END) as <span class="string">'Apr_Revenue'</span>,</span><br><span class="line">       sum(CASE when month=<span class="string">'may'</span> <span class="keyword">then</span> revenue <span class="keyword">else</span> null END) as <span class="string">'May_Revenue'</span>,</span><br><span class="line">       sum(CASE when month=<span class="string">'jun'</span> <span class="keyword">then</span> revenue <span class="keyword">else</span> null END) as <span class="string">'Jun_Revenue'</span>,</span><br><span class="line">       sum(CASE when month=<span class="string">'jul'</span> <span class="keyword">then</span> revenue <span class="keyword">else</span> null END) as <span class="string">'Jul_Revenue'</span>,</span><br><span class="line">       sum(CASE when month=<span class="string">'aug'</span> <span class="keyword">then</span> revenue <span class="keyword">else</span> null END) as <span class="string">'Aug_Revenue'</span>,</span><br><span class="line">       sum(CASE when month=<span class="string">'sep'</span> <span class="keyword">then</span> revenue <span class="keyword">else</span> null END) as <span class="string">'Sep_Revenue'</span>,</span><br><span class="line">       sum(CASE when month=<span class="string">'oct'</span> <span class="keyword">then</span> revenue <span class="keyword">else</span> null END) as <span class="string">'Oct_Revenue'</span>,</span><br><span class="line">       sum(CASE when month=<span class="string">'nov'</span> <span class="keyword">then</span> revenue <span class="keyword">else</span> null END) as <span class="string">'Nov_Revenue'</span>,</span><br><span class="line">       sum(CASE when month=<span class="string">'dec'</span> <span class="keyword">then</span> revenue <span class="keyword">else</span> null END) as <span class="string">'Dec_Revenue'</span></span><br><span class="line">from department</span><br><span class="line">group by id</span><br></pre></td></tr></table></figure>

<p>备注：<br>1）需要注意的是用到了<code>sum()</code>和<code>group by id</code>，因为如果不用sum的话，就会出现每条记录对应的别的记录其实是有数值的会在这条记录中显示为null，因此需要用sum()或者max()来在多个取值中选择有数值的而非null，这道题目因为每个月每个部门只有一条记录，所以用max或者sum都可以，但如果是有多条记录的话，用sum()会更合适<br>2) 注意是<code>group by id</code>而不是<code>group by month</code>，因为已经把每个月给单独写出来了，不需要通过group by month来为不同月份分组计算，使用group by的目的是为了sum，因此需用id这种不会因group而汇总的参数。<br>3）distinct只是写作习惯，不写也可以，但实测发现写distinct的运算时间为690m，不写distinct会更慢运算时间要1116ms</p>
<p>第二种方法，if()函数，具体如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">select id,</span><br><span class="line">       sum(<span class="keyword">if</span>(month=<span class="string">'jan'</span>, revenue, null)) as <span class="string">'Jan_Revenue'</span>,</span><br><span class="line">       sum(<span class="keyword">if</span>(month=<span class="string">'feb'</span>, revenue, null)) as <span class="string">'Feb_Revenue'</span>,</span><br><span class="line">       sum(<span class="keyword">if</span>(month=<span class="string">'mar'</span>, revenue, null)) as <span class="string">'Mar_Revenue'</span>,</span><br><span class="line">       sum(<span class="keyword">if</span>(month=<span class="string">'apr'</span>, revenue, null)) as <span class="string">'Apr_Revenue'</span>,</span><br><span class="line">       sum(<span class="keyword">if</span>(month=<span class="string">'may'</span>, revenue, null)) as <span class="string">'May_Revenue'</span>,</span><br><span class="line">       sum(<span class="keyword">if</span>(month=<span class="string">'jun'</span>, revenue, null)) as <span class="string">'Jun_Revenue'</span>,</span><br><span class="line">       sum(<span class="keyword">if</span>(month=<span class="string">'jul'</span>, revenue, null)) as <span class="string">'Jul_Revenue'</span>,</span><br><span class="line">       sum(<span class="keyword">if</span>(month=<span class="string">'aug'</span>, revenue, null)) as <span class="string">'Aug_Revenue'</span>,</span><br><span class="line">       sum(<span class="keyword">if</span>(month=<span class="string">'sep'</span>, revenue, null)) as <span class="string">'Sep_Revenue'</span>,</span><br><span class="line">       sum(<span class="keyword">if</span>(month=<span class="string">'oct'</span>, revenue, null)) as <span class="string">'Oct_Revenue'</span>,</span><br><span class="line">       sum(<span class="keyword">if</span>(month=<span class="string">'nov'</span>, revenue, null)) as <span class="string">'Nov_Revenue'</span>,</span><br><span class="line">       sum(<span class="keyword">if</span>(month=<span class="string">'dec'</span>, revenue, null)) as <span class="string">'Dec_Revenue'</span></span><br><span class="line">from department</span><br><span class="line">group by id</span><br></pre></td></tr></table></figure>

<p>备注：<br>1）仍是用到了sum()和group by<br>2）这种方法运算时间为734ms，很有趣的是如果加distinct，运算时间为774ms，相差不大</p>
<p>第三种方法，pivot，具体如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">select id,</span><br><span class="line">       jan as Jan_revenue,</span><br><span class="line">       feb as Feb_revenue,</span><br><span class="line">       mar as Mar_revenue,</span><br><span class="line">       apr as Apr_revenue,</span><br><span class="line">       may as May_revenue,</span><br><span class="line">       jun as Jun_revenue,</span><br><span class="line">       jul as Jul_revenue,</span><br><span class="line">       aug as Aug_revenue,</span><br><span class="line">       sep as Sep_revenue,</span><br><span class="line">       oct as Oct_revenue,</span><br><span class="line">       nov as Nov_revenue,</span><br><span class="line">       dec as Dec_revenue</span><br><span class="line">from (select id,revenue,month from department) as base</span><br><span class="line">pivot (sum(revenue) <span class="keyword">for</span> month <span class="keyword">in</span>(jan,feb,mar,apr,may,jun,jul,aug,sep,oct,nov,dec)) as pvt</span><br></pre></td></tr></table></figure>

<p>备注：<br>1）大部分版本的mysql不支持pivot，以上是在ms sql server中的写法<br>2）运算时间1315ms<br>3）考虑兼容性，列转行尽量使用case when/if而非pivot，行转列尽量使用union all而非unpivot</p>
<h5 id="问题9-定义函数"><a href="#问题9-定义函数" class="headerlink" title="问题9 定义函数"></a>问题9 定义函数</h5><p>【涉及知识点】<br>有时需要返回的内容并非一个固定参数，而是会需要根据情况调整输入参数的，这时需要定义函数。<br>定义函数的基本格式为：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">CREATE FUNCTION functionname(n int/varchar) RETURNS int/varchar <span class="comment">#定义functionname函数，参数n，参数格式是数字/字符，返回值是数字/字符</span></span><br><span class="line">BEGIN <span class="comment">#定义的参数不能表达为数学式，如有计算需要需设定其它参数并定义其与参数n的关系</span></span><br><span class="line">      DECLARE 参数名m 参数格式int; <span class="comment">#与定义函数名和参数格式时一样中间用空格隔开，注意结尾需:</span></span><br><span class="line">      SET m=n+1; <span class="comment">#set后面是declare的参数与函数参数n的关系，注意需;结尾</span></span><br><span class="line">  RETURN (  select... ); <span class="comment">#中间是正常的查询分析语句，把平时固定的某数值替换为函数参数n即可，</span></span><br><span class="line">                         <span class="comment">#注意需打括号，括号后有;，注意是return而不是前面定义函数名时用的returns</span></span><br><span class="line">END; <span class="comment">#注意有begin就要有end，end后面有没有;都可以</span></span><br></pre></td></tr></table></figure>

<p>【例题】#177 <a href="https://leetcode.com/problems/nth-highest-salary/" target="_blank" rel="noopener">Nth Highest Salary</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">Write a SQL query to get the nth highest salary from the Employee table.</span><br><span class="line"></span><br><span class="line">+----+--------+</span><br><span class="line">| Id | Salary |</span><br><span class="line">+----+--------+</span><br><span class="line">| 1  | 100    |</span><br><span class="line">| 2  | 200    |</span><br><span class="line">| 3  | 300    |</span><br><span class="line">+----+--------+</span><br><span class="line">For example, given the above Employee table, the nth highest salary <span class="built_in">where</span> n = 2 is 200.</span><br><span class="line"> If there is no nth highest salary, <span class="keyword">then</span> the query should <span class="built_in">return</span> null.</span><br><span class="line"></span><br><span class="line">+------------------------+</span><br><span class="line">| getNthHighestSalary(2) |</span><br><span class="line">+------------------------+</span><br><span class="line">| 200                    |</span><br><span class="line">+------------------------+</span><br></pre></td></tr></table></figure>

<p>【解析】<br>本身是一个非常简单的前几问题，但由于需要定义一个函数来方便输入第几的数字，因此需要把简单的前几查询略作修改变成函数定义。具体如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">CREATE FUNCTION getNthHighestSalary(N int) RETURNS int</span><br><span class="line"></span><br><span class="line">BEGIN</span><br><span class="line"></span><br><span class="line"> DECLARE M int;</span><br><span class="line"> SET M=N-1;</span><br><span class="line"></span><br><span class="line"> RETURN</span><br><span class="line"> (</span><br><span class="line">      select distinct salary</span><br><span class="line">      from employee</span><br><span class="line">      order by salary desc</span><br><span class="line">      <span class="built_in">limit</span> 1 offset M</span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line">END;</span><br></pre></td></tr></table></figure>

<p>格式中需要注意的点包括：<br>1）函数名的名字就是需要返回的列名，下面写函数时就无需as了<br>2）函数名后面括号内的参数名和参数格式中间的是空格，而不是逗号<br>3）定义函数名时用的returns有个s，后面接的是返回值的格式<br>4）create function returns这句后面无需使用符号<br>5）begin后如果没什么要设定的可以直接接return<br>6）如果在查询语句中不能直接使用参数而需要参数的计算后变形，那么需要在begin后先declare另一个辅助参数，然后set辅助参数与函数参数之间的关系，注意declare句后和set句后均有;分号<br>7）return后面的如果是整个查询语句的话，需要把查询语句括号起来，注意括号后有;分号<br>8）最后别忘了有begin就会有end，而end后面有没有;都可以的</p>
<h5 id="问题10-排名"><a href="#问题10-排名" class="headerlink" title="问题10 排名"></a>问题10 排名</h5><p>【涉及知识点】<br>需要注意的是，这里所说的排名与排序不同，重点是需要为每行返回一个代表其名次的数字，这涉及到的核心功能仍是自定义函数，但不同于create function，这里的自定义函数是在查询语句中间实现的，也并不需要面向不同的输入参数。<br>通过自定义函数创建一列新的行序数字的基本格式是：<br><code>select table.*, @rownum:=@rownum+1 from table, (select @rownum:=0) as r</code></p>
<p>【例题】#178 <a href="https://leetcode.com/problems/rank-scores/" target="_blank" rel="noopener">Rank Scores</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">Write a SQL query to rank scores. If there is a tie between two scores, both should have the same ranking. </span><br><span class="line">Note that after a tie, the next ranking number should be the next consecutive <span class="built_in">integer</span> value. </span><br><span class="line">In other words, there should be no <span class="string">"holes"</span> between ranks.</span><br><span class="line"></span><br><span class="line">+----+-------+</span><br><span class="line">| Id | Score |</span><br><span class="line">+----+-------+</span><br><span class="line">| 1  | 3.50  |</span><br><span class="line">| 2  | 3.65  |</span><br><span class="line">| 3  | 4.00  |</span><br><span class="line">| 4  | 3.85  |</span><br><span class="line">| 5  | 4.00  |</span><br><span class="line">| 6  | 3.65  |</span><br><span class="line">+----+-------+</span><br><span class="line">For example, given the above Scores table, your query should generate the following report (order </span><br><span class="line">  by highest score):</span><br><span class="line"></span><br><span class="line">+-------+------+</span><br><span class="line">| Score | Rank |</span><br><span class="line">+-------+------+</span><br><span class="line">| 4.00  | 1    |</span><br><span class="line">| 4.00  | 1    |</span><br><span class="line">| 3.85  | 2    |</span><br><span class="line">| 3.65  | 3    |</span><br><span class="line">| 3.65  | 3    |</span><br><span class="line">| 3.50  | 4    |</span><br><span class="line">+-------+------+</span><br></pre></td></tr></table></figure>

<p>【解析】<br>可以想到输出结果是由两个表并成的，一个表是每个分数对应的排名，这需要将分数剔重以后排序再通过自定义函数得出每行的行数数值，第二个表是包含相同分数的原始表格，需要按照分数从高到低排列。具体如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">select s1.Score, s3.Rank</span><br><span class="line">from scores s1</span><br><span class="line">left join</span><br><span class="line">(</span><br><span class="line"> select s2.score, @rownum:=@rownum+1 as Rank </span><br><span class="line"> from (select distinct score from scores order by score desc) s2, (select @rownum:=0) r</span><br><span class="line">) s3</span><br><span class="line">on s1.score=s3.score</span><br><span class="line">order by rank</span><br></pre></td></tr></table></figure>

<p>需注意的是，对获取排名值的表需要嵌套一次，因为需要剔除重复的和排序，而如果不嵌套而是把distinct，order by，自定义rownum函数全放在同一层的话会报错。</p>
<h5 id="问题11-比率"><a href="#问题11-比率" class="headerlink" title="问题11 比率"></a>问题11 比率</h5><p>【涉及知识点】<br>拆表再并表<br>用case when将符合条件的赋值1，不符合条件的赋值0，使用sum计算出所有符合条件的，除以count全部。</p>
<p>【例题】#262 <a href="https://leetcode.com/problems/trips-and-users/" target="_blank" rel="noopener">Trips and Users</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">The Trips table holds all taxi trips. Each trip has a unique Id, <span class="keyword">while</span> Client_Id and Driver_Id </span><br><span class="line">are both foreign keys to the Users_Id at the Users table. Status is an ENUM <span class="built_in">type</span> of (‘completed’, </span><br><span class="line">  ‘cancelled_by_driver’, ‘cancelled_by_client’).</span><br><span class="line"></span><br><span class="line">+----+-----------+-----------+---------+--------------------+----------+</span><br><span class="line">| Id | Client_Id | Driver_Id | City_Id |        Status      |Request_at|</span><br><span class="line">+----+-----------+-----------+---------+--------------------+----------+</span><br><span class="line">| 1  |     1     |    10     |    1    |     completed      |2013-10-01|</span><br><span class="line">| 2  |     2     |    11     |    1    | cancelled_by_driver|2013-10-01|</span><br><span class="line">| 3  |     3     |    12     |    6    |     completed      |2013-10-01|</span><br><span class="line">| 4  |     4     |    13     |    6    | cancelled_by_client|2013-10-01|</span><br><span class="line">| 5  |     1     |    10     |    1    |     completed      |2013-10-02|</span><br><span class="line">| 6  |     2     |    11     |    6    |     completed      |2013-10-02|</span><br><span class="line">| 7  |     3     |    12     |    6    |     completed      |2013-10-02|</span><br><span class="line">| 8  |     2     |    12     |    12   |     completed      |2013-10-03|</span><br><span class="line">| 9  |     3     |    10     |    12   |     completed      |2013-10-03| </span><br><span class="line">| 10 |     4     |    13     |    12   | cancelled_by_driver|2013-10-03|</span><br><span class="line">+----+-----------+-----------+---------+--------------------+----------+</span><br><span class="line">The Users table holds all users. Each user has an unique Users_Id, and Role is an ENUM </span><br><span class="line"> <span class="built_in">type</span> of (‘client’, ‘driver’, ‘partner’).</span><br><span class="line"></span><br><span class="line">+----------+--------+--------+</span><br><span class="line">| Users_Id | Banned |  Role  |</span><br><span class="line">+----------+--------+--------+</span><br><span class="line">|    1     |   No   | client |</span><br><span class="line">|    2     |   Yes  | client |</span><br><span class="line">|    3     |   No   | client |</span><br><span class="line">|    4     |   No   | client |</span><br><span class="line">|    10    |   No   | driver |</span><br><span class="line">|    11    |   No   | driver |</span><br><span class="line">|    12    |   No   | driver |</span><br><span class="line">|    13    |   No   | driver |</span><br><span class="line">+----------+--------+--------+</span><br><span class="line">Write a SQL query to find the cancellation rate of requests made by unbanned users (both client and </span><br><span class="line">driver must be unbanned) between Oct 1, 2013 and Oct 3, 2013. </span><br><span class="line">The cancellation rate is computed by dividing the number of canceled (by client or driver) requests </span><br><span class="line">made by unbanned users by the total number of requests made by unbanned users.</span><br><span class="line"></span><br><span class="line">For the above tables, your SQL query should <span class="built_in">return</span> the following rows with the cancellation rate </span><br><span class="line"> being rounded to two decimal places.</span><br><span class="line"></span><br><span class="line">+------------+-------------------+</span><br><span class="line">|     Day    | Cancellation Rate |</span><br><span class="line">+------------+-------------------+</span><br><span class="line">| 2013-10-01 |       0.33        |</span><br><span class="line">| 2013-10-02 |       0.00        |</span><br><span class="line">| 2013-10-03 |       0.50        |</span><br><span class="line">+------------+-------------------+</span><br></pre></td></tr></table></figure>

<p>【解析】<br>先并表，在并表过程中通过<code>where</code>把被禁用户和不符合日期的记录给直接剔除掉。<br>然后在求取消率时，分母可以直接用<code>count()</code>，分子如果用count就不能再设条件，因此用<code>sum()</code>，把符合条件带cancelled的条目赋值1其它赋值0，注意根据要求是精确到小数点后两位，因此需要用<code>round(num,2)</code>。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">select distinct t.request_at as <span class="string">'Day'</span>, </span><br><span class="line">       round(sum(<span class="keyword">case</span> when t.status like <span class="string">'%cancelled%'</span> <span class="keyword">then</span> 1 <span class="keyword">else</span> 0 end)/count(t.id), 2) as <span class="string">'Cancellation Rate'</span></span><br><span class="line">from trips t</span><br><span class="line">join users u1</span><br><span class="line">join users u2</span><br><span class="line">on t.client_id=u1.users_id and t.driver_id=u2.users_id</span><br><span class="line"><span class="built_in">where</span> u1.banned=<span class="string">'no'</span>and u2.banned=<span class="string">'no'</span> </span><br><span class="line">and t.request_at&gt;=<span class="string">'2013-10-01'</span> and t.request_at&lt;=<span class="string">'2013-10-03'</span></span><br><span class="line">group by request_at</span><br><span class="line">order by request_at</span><br></pre></td></tr></table></figure>

<p>注意：<br>1）<code>like</code>前面没有<code>is</code>，后面的模糊字符串需要用<code>&#39;&#39;</code>框起来。<br>2）三个表可以一起连，直接<code>join join on</code>，而无需<code>join on join on</code><br>3）日期可以直接用大于小于这样的符号，但需注意，日期也需用<code>&#39;&#39;</code>框起来，否则会报错。</p>
<h4 id="数据库维护相关"><a href="#数据库维护相关" class="headerlink" title="数据库维护相关"></a>数据库维护相关</h4><h5 id="问题1-删重"><a href="#问题1-删重" class="headerlink" title="问题1 删重"></a>问题1 删重</h5><p>【涉及知识点】<br>删除某行的格式：<code>delete * from table where</code>，和select的格式是一样的，只是换成delete，且因为是删整行，所以一般是<code>*</code>或者<code>table.*</code>而不像select需要写明选出来的是行里的哪些列参数。<br>删重还是剔重：一般原则上是不要删数据，用的时候选出不重复的就行了，也即是用distinct，但不排除有时确有删除数据库中的冗余数据的维护数据库而非从数据库中调用数据进行分析的情况。</p>
<p>【例题】#196 <a href="https://leetcode.com/problems/delete-duplicate-emails/" target="_blank" rel="noopener">Delete Duplicate Emails</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">Write a SQL query to delete all duplicate email entries <span class="keyword">in</span> a table named Person, </span><br><span class="line">keeping only unique emails based on its smallest Id.</span><br><span class="line"></span><br><span class="line">+----+------------------+</span><br><span class="line">| Id | Email            |</span><br><span class="line">+----+------------------+</span><br><span class="line">| 1  | john@example.com |</span><br><span class="line">| 2  | bob@example.com  |</span><br><span class="line">| 3  | john@example.com |</span><br><span class="line">+----+------------------+</span><br><span class="line">Id is the primary key column <span class="keyword">for</span> this table.</span><br><span class="line">For example, after running your query, the above Person table should have the following rows:</span><br><span class="line"></span><br><span class="line">+----+------------------+</span><br><span class="line">| Id | Email            |</span><br><span class="line">+----+------------------+</span><br><span class="line">| 1  | john@example.com |</span><br><span class="line">| 2  | bob@example.com  |</span><br><span class="line">+----+------------------+</span><br><span class="line">Note:</span><br><span class="line"></span><br><span class="line">Your output is the whole Person table after executing your sql. Use delete statement.</span><br></pre></td></tr></table></figure>

<p>【解析】<br>和查重的思路很相似，也是要么先拆表再转化成比较问题，要么计算每个值有多少个。</p>
<p>第一种方法，拆表再对比，把查重时的select改为删除时的delete就行了，注意因为要求保留较小的一个id，因此比较的时候不是不等于而是大于。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">delete p1.*</span><br><span class="line">from person p1,</span><br><span class="line">     person p2</span><br><span class="line"><span class="built_in">where</span> p1.id &gt; p2.id</span><br><span class="line">and p1.email = p2.email</span><br></pre></td></tr></table></figure>

<p>备注：<br>1）这种方法的运算时间是1110ms<br>2）这里的delete后面有<code>*</code>，是因为删除表格的依据是整表，而不是某个指标。</p>
<p>第二种方法，把表格按每个email来group by，然后这里我们不需要计数，只需要求出id最小的需要保留的是哪些，然后删除那些不属于这些id的就可以了。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">delete </span><br><span class="line">from person</span><br><span class="line"><span class="built_in">where</span> id not <span class="keyword">in</span> (</span><br><span class="line">                select id from</span><br><span class="line">                (select min(id) as <span class="string">'id'</span>,email</span><br><span class="line">                 from person</span><br><span class="line">                 group by email) minid</span><br></pre></td></tr></table></figure>

<p>备注：<br>1）这种方法的运算时间是1846ms<br>2）这里的delete后面没有<code>*</code>，而是直接接from，因为后面是where所限定的一个指标id<br>3）id not in的括号内必须嵌套一次，而不能直接一次，否则会报错，原因不明。</p>
<h5 id="问题2-更新数据"><a href="#问题2-更新数据" class="headerlink" title="问题2 更新数据"></a>问题2 更新数据</h5><p>【涉及知识点】<br>更新数据的基本格式：<br><code>update table set column-need-to-be-update=xxx where column-condition=mmm</code></p>
<p>【例题】 前面分析互换问题时在例题627中已经讲过，不赘述。</p>

        
      
    </div>

    
    
    
      <footer class="post-footer">
          <div class="post-eof"></div>
        
      </footer>
  </div>
  
  
  
  </article>

       
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
       
        <article itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block home">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/10/11/notes-skill-blog-on-github/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Brielley">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Brielley">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
            
            <a href="/2019/10/11/notes-skill-blog-on-github/" class="post-title-link" itemprop="url">How to Build a Blog on Github Pages</a>
          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              
                
              

              <time title="Created: 2019-10-11 13:55:33" itemprop="dateCreated datePublished" datetime="2019-10-11T13:55:33+08:00">2019-10-11</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2021-03-23 14:34:11" itemprop="dateModified" datetime="2021-03-23T14:34:11+08:00">2021-03-23</time>
              </span>
            
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Tech/" itemprop="url" rel="index"><span itemprop="name">Tech</span></a></span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Tech/Blog/" itemprop="url" rel="index"><span itemprop="name">Blog</span></a></span>

                
                
              
            </span>
          

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>最近在考虑找个地儿给文存档，于是研究了下怎么搭博客。过程中找了不少资料也踩了不少坑，决定写下这篇简易教程，一方面给有需要的人做参考，另一方面也趁记忆尚热理顺留档自己备用。</p>
<p>事实上，在搭博客的过程中我搜到了不少教程，但我搜到的这些都或多或少地有着这样那样的问题，没有一份能够直接让人照着它把博客搭好。我想这主要是因为，我所选择的搭建博客的github平台和博客框架hexo以及其所集成的功能模块在github上的开源项目一直处于版本更迭中，许多命令语句或是操作步骤在我使用时已经与它们在教程中被写下的时候不同了。而大部分教程往往仅给出了当时的命令语句，并没有解释自己是在做什么，为什么要这么做，从哪里知道的该这么做，于是在版本更迭做的方式发生改变之后，就让人既无法依葫芦画瓢又对哪里出了问题该怎么改一头雾水。不过所幸由于它们都是开源项目，有项目名称就可以去项目所在地看readme，有的大项目还有非常详尽的documentation，这样磕磕绊绊踩着坑总算把博客差不多搭起来了。</p>
<p>有鉴于此，这篇简易教程会考虑到面向的主要是如我这样木啥coding基础的使用者，在列出当前可用的怎么做的基础上，会更多地写明这是在做什么，为什么这么做，从哪里知道的要怎么做，未来如果版本更迭该怎么做要去哪儿找。</p>
<p>需要说明的是，这篇博客搭建教程受限于我的经验和个人需求，一些原理可能存在理解错误，一些我没有需求的建站技巧在这篇文章中将不会涉及。</p>
<h2 id="1-前言"><a href="#1-前言" class="headerlink" title="1 前言"></a>1 前言</h2><h3 id="1-1-本文适用性"><a href="#1-1-本文适用性" class="headerlink" title="1.1 本文适用性"></a>1.1 本文适用性</h3><p>在搭博客之前，需要先想好自己的需求是什么，这会影响你选择搭建哪一类博客。因为不同类别的博客需要的东西是大不相同的。总体而言，网页分为两种，静态的和动态的。静态的网页并不是说页面上没有动态特效，而是说每一个页面都是事先写好的，访问者看到的是固定的页面，不同访客看到的页面是完全一样的；而动态的网页则不是事先写好的固定的页面，而是由访问者发起需求以后，从数据库中调取相应的信息自动生成的，不同访客看到的页面往往是不同的。</p>
<p>所以，如果你有几千张图，需要根据访客的兴趣自动生成他们的首页，或者希望把它做成一个类似论坛或是电商那样有着极强互动性的平台，那么你需要做动态网页需要数据库，而这篇教程对这些都不会涉及。</p>
<p>如果你和我一样，只需要给自己的博文存档，让访客可以通过分类目录通过时间线通过tag通过站内搜索方便地查找和阅读你的博文，在互动上仅需最基本的评论留言功能，那么这篇教程或许能给你提供一些参考。</p>
<h3 id="1-2-平台的选择"><a href="#1-2-平台的选择" class="headerlink" title="1.2 平台的选择"></a>1.2 平台的选择</h3><p>我选择的平台是github，使用的博客框架为hexo。选择github是因为它家提供免费的域名和没有空间限制的云服务器，只需要邮箱注册就可以了，不需要科学上网，作为世界上最大的码农同性交友平台应该能too big to fail实现我不需要频繁搬家的存档需求。而如果自行购买域名和云服务器搭建，除了费用以外还需走备案流程，所需耗费的时间精力要高出不少。</p>
<p>而选择hexo则是在选择github后的一个水到渠成的选择，因为hexo原本便是github上的一个开源项目，与github page的适配性非常强。hexo很好上手，有非常详尽的说明文档，也有不少完成度高的开放的UI模板可以选择，对我这样对代码对美术都外行的人而言非常方便。尽管我在搜索中发现wordpress的市占似乎比hexo高出不少，所建的博客页面也更丰富酷炫，但考虑到最先接触的hexo已能满足我的需求，便没再增加学习成本去尝试别的博客框架了。</p>
<h2 id="2-搭建一个硬盘博客"><a href="#2-搭建一个硬盘博客" class="headerlink" title="2 搭建一个硬盘博客"></a>2 搭建一个硬盘博客</h2><p>搭建博客的工作大致来说可以分为两大类，一是做博客本身，二是把它放到网上让他人可以访问。我们这里先做第一类工作，也就是搭一个本地的博客，就像硬盘文一样，这一步完成后，它只能在自己的电脑上看到。下一步我们再把它放到网上。</p>
<p>一个本地的博客需要什么呢？我们想象一下，我们需要浏览器页面上能按照我们需要的排版显示我们的博文，还需要一些分类归档的功能来方便我们把系列的文章放在一起，最好还有个目录有个时间线有个tag云有个本地搜索什么的。由于我们做的是静态网页，因此我们需要把每一页写出来。现在可以右键点开查看网页源代码，看看我们当前这个页面写出来是什么样的，我们会发现这是一个非常浩大的工作，而且有一些目录时间线tag云啥的功能我们完全不知道应该肿么写。那么，有没有什么东西，能帮助我们批量生成大量这样的代码（毕竟有很多格式排版是重复的），实现那些功能，我们只需要根据自己的需求调整一些设置，把工作量降低到只写非写不可的呢？</p>
<p>答案是有的，这便是前面我们提到过很多次的博客框架。博客框架的存在意义在于我们可以用它来省掉敲绝大多数的代码，只需要我们用它能理解的语言（在本文里是markdown）来写我们的博文，然后它会帮我们转化生成网页所需的前端语言，使得我们的博文显示在我们本地的浏览器，以及在之后部署到网络上后显示在访客的浏览器上。</p>
<h3 id="2-1-安装博客框架hexo"><a href="#2-1-安装博客框架hexo" class="headerlink" title="2.1 安装博客框架hexo"></a>2.1 安装博客框架hexo</h3><h4 id="2-1-1-安装git和node-js"><a href="#2-1-1-安装git和node-js" class="headerlink" title="2.1.1 安装git和node.js"></a>2.1.1 安装git和node.js</h4><p>如同过去我们要玩一款单机游戏，需要先在电脑中安装好它运行所依赖的java或是c或是flash或是DirectX这些平台才能愉快的玩耍一样；博客框架hexo基于git和node.js。因此，在安装使用hexo之前需要首先安装这两个软件，前往git(<a href="https://git-scm.com/downloads" target="_blank" rel="noopener">https://git-scm.com/downloads</a>) 和node.js(<a href="https://nodejs.org/en/download/" target="_blank" rel="noopener">https://nodejs.org/en/download/</a>) 的官网去分别下载它们的适用于自己电脑的版本，安装时的选项均选择默认安装即可。</p>
<p>需要说明的是，本文的运行环境是windows，如果你是mac，安装方式会有所不同，前往hexo官网，在docs中会有对mac的安装指引。</p>
<h4 id="2-1-2-安装hexo"><a href="#2-1-2-安装hexo" class="headerlink" title="2.1.2 安装hexo"></a>2.1.2 安装hexo</h4><p>安装好这两个软件后，我们接下来就可以安装hexo了。在电脑中选择一个位置新建一个文件夹用来做博客所有文件的存放处。我给文件夹的命名是blog，在后面需要举到这个文件夹名称时我会用blog文件夹这个名字，但你可以给它取任何名字，最好是字母构成的避免在命令中出bug。</p>
<p>或许你会觉得很奇怪，一般软件在安装过程中只要选择了安装路径不是会自动创建文件夹的么，为什么我们要先自己创建一个文件夹？这是因为，hexo的安装和我们过去常用的软件安装方法不大一样，我们并不是下载一个安装包然后点开它根据对话框里的提示完成安装，而是使用命令语句来完成。你可能过去曾经用过windows的运行cmd里的命令（我在U盘时代会进这里来查看在打印店插过的U盘里有没有多出什么奇奇怪怪的隐藏文件删掉），而对hexo的从安装到使用的操作也是用类似的方式进行的。只是由于运行cmd对部分hexo的语句不支持，因此我们这里不是从运行cmd里而是用之前我们安装的git软件来写命令。</p>
<p>在blog文件夹里右键打开git bash，然后输入hexo的安装命令语句。这个语句改了很多次，它们过往的残骸被分布在各种hexo教程里。在你安装使用hexo的时候，最好去它的官网说明文档里确认一下最新的语句是什么。路径是Hexo-Docs-Overview，如果hexo没有对它家网页做大的变动的话会在这里(<a href="https://hexo.io/docs/" target="_blank" rel="noopener">https://hexo.io/docs/</a>) 。在我写这篇博文时的安装命令语句是：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install hexo-cli -g</span><br></pre></td></tr></table></figure>

<h4 id="2-1-3-初始化hexo"><a href="#2-1-3-初始化hexo" class="headerlink" title="2.1.3 初始化hexo"></a>2.1.3 初始化hexo</h4><p>安装好hexo后，我们需要对它进行初始化，初始化语句同样最好先参看hexo提供的最新语句，路径在Hexo-Docs-Setup，如果官网没做大改应该在这里(<a href="https://hexo.io/docs/setup" target="_blank" rel="noopener">https://hexo.io/docs/setup</a>) 。在我写博文时的初始化命令语句是：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ hexo init blog</span><br><span class="line">$ <span class="built_in">cd</span> blog</span><br><span class="line">$ npm install</span><br></pre></td></tr></table></figure>

<p>如果你给文件夹的命名不是blog，把上面的blog换成你的文件夹名就好了。然后我们会看到blog文件夹下出现了大量文件，这时hexo就已经安装到我们的电脑上了。这些文件中，我们在配置博客时会比较常用到的是_config.yml配置文件和theme文件夹，在日后写博文时经常用到的是source文件夹，后面讲到这些内容的时候再详细讲它们。</p>
<h4 id="2-1-4-查看初始博客页面"><a href="#2-1-4-查看初始博客页面" class="headerlink" title="2.1.4 查看初始博客页面"></a>2.1.4 查看初始博客页面</h4><p>接下来我们可以修改博客的一些基础配置，但我觉得看着预览修改会更直观一些，而现在我们已经可以看到本地预览了。输入下面的命令，或者在Hexo-Docs-Commands(<a href="https://hexo.io/docs/commands" target="_blank" rel="noopener">https://hexo.io/docs/commands</a>) 中找到server所对应的最新命令语句。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo s</span><br></pre></td></tr></table></figure>

<p>然后在浏览器地址栏中输入<code>localhost:4000</code>，就可以看到这个本地博客的预览页面了。注意：预览时不要关掉git bash，否则页面就无法显示了。同时，在预览中，我们的git bash没法进行其它的命令，如果要使用git bash，需要先按ctrl+c退出预览，然后再输入命令。</p>
<h4 id="2-1-5-修改博客基本信息"><a href="#2-1-5-修改博客基本信息" class="headerlink" title="2.1.5 修改博客基本信息"></a>2.1.5 修改博客基本信息</h4><p>我们会发现这个初始的博客里有很多信息和自己是不符的，比如博客的作者，比如博客的标题，这些我们可以在blog文件夹下的_config.yml文件中进行修改。</p>
<p>_congif.yml文件可以用windows自带的记事本打开，但我更建议下载一个<a href="http://www.sublimetext.com/" target="_blank" rel="noopener">sublime text</a> ，因为现在这个简短的配置文件还好，在之后我们要修改的主题配置文件那种上千行的代码在记事本的白底黑字中会非常容易误操作。而在以后写博文的时候我们也会觉得记事本中一个自然段就是一行超出页面范围了也不会在显示中自动换行的显示方式让人抓狂。sublime会通过分组缩进连线用不同颜色显示等等方法，来让代码看起来逻辑清晰，减少误操作的可能。sublime是免费的，尽管在使用中它会不时提醒你付费，但坚持不付费它也会让你一直试用下去。我的sublime从三年前一门心血来潮后来不出意外半途而废的前端mooc上收到安利安装至今，仍然没有因为未付费而被停用。</p>
<p>说回配置文件的修改，我们可以看到_config.yml里第5-12行是关于页面的设置。其中第6行title后面，我们可以输入自己博客的标题，第7行subtitle是副标题，会显示在标题的下方，与第8行description的区别在于后者会显示在作者的下方，而作者在第10行author处修改。第11行是博客的语言，默认是英文en，如果需要修改为中文，把en改为zh-CN就好了。第12行时区如果空着会根据系统默认来显示，不会受选择语言的影响。</p>
<p>需要注意的是在填写或修改以上内容的时候，填写的内容与冒号之间需要空一个空格，冒号如果不小心删除了自己补上的时候记得在英文输入法下输入。</p>
<p>继续在git bash中$ hexo s一下，打开localhost:4000，看看现在博客的标题和用户是否已经改好。如果之前没有退出hexo s，只需要把之前打开的预览页面刷新一下就可以了。</p>
<h3 id="2-2-美化博客界面"><a href="#2-2-美化博客界面" class="headerlink" title="2.2 美化博客界面"></a>2.2 美化博客界面</h3><p>我们现在的初始博客界面非常辣眼，在_config.yml的倒数第二大段#extensions中我们能看到它的主题theme是叫landscape，在blog文件夹下的themes子文件夹中我们也能看到landscape主题文件夹。虽然也能直接在这个主题界面下修改，但如果它和你心目中的博客页面相去太远，更便捷的做法无疑是先换一个与你理想的博客页面更接近的，再在那个主题的基础上修改。</p>
<h4 id="2-2-1-下载主题"><a href="#2-2-1-下载主题" class="headerlink" title="2.2.1 下载主题"></a>2.2.1 下载主题</h4><p>在hexo的网页上，有许多其它用户制作的开放的主题页面(<a href="https://hexo.io/themes/" target="_blank" rel="noopener">https://hexo.io/themes/</a>) ，可以从中选择一款自己相对喜欢且功能齐全的，把它下载到本地，解压后的文件夹放在blog文件夹下的themes子文件夹中。</p>
<h4 id="2-2-2-应用主题"><a href="#2-2-2-应用主题" class="headerlink" title="2.2.2 应用主题"></a>2.2.2 应用主题</h4><p>打开blog文件夹里的_config.yml（注意：是blog文件夹下，而非themes子文件夹下的某个主题文件夹内的同名文件），找到<code>theme: landscape</code>这一行语句，把landscape改成你theme文件夹下新主题文件夹的名称，保存退出。</p>
<p>此时再次通过$ hexo s预览，会发现localhost:4000中的页面已经按照新下载的主题来显示了。</p>
<h4 id="2-2-3-配置主题"><a href="#2-2-3-配置主题" class="headerlink" title="2.2.3 配置主题"></a>2.2.3 配置主题</h4><p>但此时的博客界面仍与我们想要的不同，这时我们需要修改主题的配置文件，来让它更接近我们心目中的样子。主题配置文件在blog/themes/你下载的主题文件名/_config.yml，注意这个文件名和之前在blog/_config.yml的文件名一模一样，但它们的位置不同，配置的项目也不同，注意不要混淆。</p>
<p>我选择的主题是next(<a href="https://github.com/theme-next/hexo-theme-next/blob/master/README.md" target="_blank" rel="noopener">https://github.com/theme-next/hexo-theme-next/blob/master/README.md</a>) ，因为在试用了几款主题后，感觉这一款相比其它几款而言界面极简清爽，集成的功能相对最齐，开放给用户自行设置的项目最多。如果你选择的其它主题，2.2.3这小节下面的内容可能无法给你提供直接参考，请参见你所选择的主题在github的项目页面，通常作者会在readme文件中对配置项目进行说明，或是直接在主题配置文件_config.yml中以注释#的形式说明。</p>
<h5 id="2-2-3-1-页面签名：第54-81行。"><a href="#2-2-3-1-页面签名：第54-81行。" class="headerlink" title="2.2.3.1 页面签名：第54-81行。"></a>2.2.3.1 页面签名：第54-81行。</h5><p>在你预览的博客页面底部，你可以看到一个由时间和你的id以及中间一个icon构成的copyright，以及下面是使用的hexo和next及其版本号的说明。对于这部分，我们可以在这里进行修改。如果你不希望博客页面上显示hexo，可以把第73和75行的true改为false，如果你不希望显示next，可以把第79和81行改为false。如果你不喜欢id和时间中间的这个黑色小人icon，可以在第62行改为你希望使用的icon，icon对应的名字可以在<a href="https://fontawesome.com/v4.7.0/icons/" target="_blank" rel="noopener">font awesome的网页</a> 上去查询，用你选择的icon的名字替换掉原本的值user就可以了。如果你希望修改这个icon的颜色，在第66行修改，注意颜色的格式是十六进制颜色代码，如果你是在PS软件上取的RGB颜色，需要转化成对应的十六进制代码。</p>
<h5 id="2-2-3-2-主题风格：第110-114行。"><a href="#2-2-3-2-主题风格：第110-114行。" class="headerlink" title="2.2.3.2 主题风格：第110-114行。"></a>2.2.3.2 主题风格：第110-114行。</h5><p>next主题提供4个不同风格的子主题，默认使用的是muse，你可以在这里改为其它3个中的一个。修改方式是把你要选的那个风格前面的注释符号#删掉，同时在muse这行最左边打个#注释掉就好。如果你是使用的sublime，会发现之前的muse这行灰了，而你新选的那个风格的那行变成了彩色。点击保存。然后$ hexo s可以看到页面已经变成了你新选择的风格。</p>
<h5 id="2-2-3-3-菜单栏：第117-142行。"><a href="#2-2-3-3-菜单栏：第117-142行。" class="headerlink" title="2.2.3.3 菜单栏：第117-142行。"></a>2.2.3.3 菜单栏：第117-142行。</h5><p>这里已经列出了许多类似主页、归档、分类、标签之类的栏目，把你希望显示在主页菜单栏上的项目前面的#取消掉让它在首页显示即可。</p>
<p>选择显示的菜单栏可以进一步进行个性化修改。在这个<code>aaa: /bbb/ || ccc</code>的格式中，其中的aaa是它在你博客首页上显示的文字，bbb是它是什么，ccc是博客首页上显示在这一条文字前面的图标。比如<code>Categories: /categories/ || th</code>，如果你希望在首页上显示的是文章类别这四个字中文，图标改成书本，那么就可以把这行语句改成<code>文章类别: /categories/ || book</code>，图标的名字和图样仍是参看font awesome的网页。</p>
<p>那么，如果我们希望做一个配置文件里没有提到过的页面该怎么办呢？比如我希望菜单里有一个JCS按钮，按钮前是个十字图标，点进去里面会是所有文章分类在jcs下的文章。只需要在<code>menu:</code>下面增加一行<code>JCS: /categories/jcs/ || plus</code>就可以了。</p>
<p>现在$ hexo s预览一下我们的页面，会发现首页的菜单栏上改成了我们希望的样子，但点进去JCS的按钮，会发现提示页面找不到。这是因为我们需要先新建一下这个页面。打开git bash，在里面输入<code>$ hexo new page JCS</code>，我们会发现在blog/source/文件夹下出现了一个叫JCS的文件夹，打开JCS文件夹下的index.md文件进行配置，里边已经有了两行语句title和date，保留它们，如果你希望修改页面上的标题，比如把JCS改成中文的万世巨星，那么在title的冒号空格后面写万世巨星就可以了。我们还可以增加一些别的设置，比如加入一行<code>type: &quot;categories&quot;</code>来规定类别，加入一行<code>comments: false</code>来让这个目录页面不要出现评论框。</p>
<h5 id="2-2-3-4-侧边栏：第145-238行。"><a href="#2-2-3-4-侧边栏：第145-238行。" class="headerlink" title="2.2.3.4 侧边栏：第145-238行。"></a>2.2.3.4 侧边栏：第145-238行。</h5><p>显示相关：侧边栏可以显示在左边或右边，如果你希望显示在右边，只需要把<code># position: right</code>前面的#删掉，再把<code>position: left</code>前面加上#注释掉就可以了。同样如果对侧边栏的宽度不满意，可以把<code># width: 300</code>前面的#删掉，然后把300改成你想要的宽度。</p>
<p>用户相关：如果你希望侧边栏上显示你的头像，可以把你选择的头像图片以avartar.png命名，然后放到blog/source/uploads文件夹下，接着把<code># In site directory (source/uploads): /uploads/avatar.png</code>这行前的#删掉就可以了。如果你希望在侧边栏上显示你的社交媒体链接，可以把social link下想要显示的栏目前的#去掉，比如你希望显示微博链接，那么把<code>#Weibo: https://weibo.com/yourname || weibo</code>前的#删掉，再把yourname改为你的微博id即可。</p>
<h5 id="2-2-3-5-阅读控件：第394-416行。"><a href="#2-2-3-5-阅读控件：第394-416行。" class="headerlink" title="2.2.3.5 阅读控件：第394-416行。"></a>2.2.3.5 阅读控件：第394-416行。</h5><p>已读百分比和回到顶端：如果希望显示回到顶端按钮，把第394-399行<code>back2top</code>栏目下的<code>enable: false</code>改为<code>true</code>就可以了，把<code>scrollpercent</code>设置为<code>true</code>则会同时显示已读百分比。如果你不希望阅读百分比在一个浮动的图标上显示，而是集成在侧边栏上，那么把<code>sidebar: false</code>改成<code>true</code>即可。</p>
<p>书签：如果希望启用书签功能，把第409-416行<code>bookmark</code>栏目下的<code>enable</code>改为<code>true</code>就可以了。然后可以在<code>color</code>后面修改书签标志的颜色。同时，如果你希望访客上次看到哪里会自动记忆书签在下次打开的时候跳转到上次的位置，那么把<code>save</code>的值命名为<code>auto</code>，否则如果设为<code>manual</code>则需要访客手动加书签。</p>
<h5 id="2-2-3-6-字体字号：第425-477行。"><a href="#2-2-3-6-字体字号：第425-477行。" class="headerlink" title="2.2.3.6 字体字号：第425-477行。"></a>2.2.3.6 字体字号：第425-477行。</h5><p>如果对博客的默认的字体字号不满意，可以在这里进行调整。需要说明的是，在调整字号的时候，是用比例而不是绝对值来表示的。比如你希望博客正文的文字小一点，那么在<code>font</code>下的<code>global</code>子栏目下的<code>size</code>后所输入的值，不能是绝对数多少多少，而是比之前的相对数比如<code>.85</code>。同理，在<code>title</code>下设置文章标题、在<code>headings</code>下设置文章内各级小标题时，在<code>size</code>后也是按照输入的比例相对数比如<code>1.75</code>等等。调整的时候可以用$ hexo s开着预览界面一点点微调到你满意的大小。</p>
<h5 id="2-2-3-7-评论功能：第597-688行。"><a href="#2-2-3-7-评论功能：第597-688行。" class="headerlink" title="2.2.3.7 评论功能：第597-688行。"></a>2.2.3.7 评论功能：第597-688行。</h5><p>hexo本身是不带评论功能的，需要外接第三方的服务。next集成了几家评论服务商，可以直接在相应的位置修改配置。但非常坑的是，他们中有的已经年久失修，有的已经吃了河蟹，有的需要实名注册，有的与我隔墙相望。我原本倾向于用同样在github上的一个开源项目gitalk，然而注册启用忙活一通以后博文页面虽然能显示评论框了，却始终没法完成初始化。我在gitalk项目的issue页面去找大家的反馈，发现有人报与我同样的问题，他后来在其他人的回复下解决了，我照着做却没能成功，我福至心灵地点进那位幸运仁兄的博客里去，却发现他的评论系统现在使用的服务商其实已经改成了livere。于是我也默默地去注册livere去了。</p>
<p>注册之后发现livere其实比我想象中要好用。最大的劣势是它是一家韩国的服务商，于是我们的博文页面在加载评论框时总是很慢，大约需要好几秒。但考虑到人总得先看了文章再评论，这个等待速度似乎也可以接受。而优势则在于对于博客作者而言只需要邮箱就可以注册，且安装极为方便。而对访客来说也非常方便，一方面可以用微博豆瓣github等第三方账号登陆，另一方面如果不愿使用第三方账号的话，用邮箱注册就可以评论了。且访客在评论时注册无需去livere网站，只需要在博文下的评论框相应位置输入邮箱设置密码就可以在评论的同时快速注册。</p>
<p>把livere的评论功能集成到博客页面上，只需要把你在livere注册后，livere提供的那串uid复制粘贴到next配置文件的<code>livere_uid:</code>后就可以了。</p>
<h5 id="2-2-3-8-搜索功能：第798-829行。"><a href="#2-2-3-8-搜索功能：第798-829行。" class="headerlink" title="2.2.3.8 搜索功能：第798-829行。"></a>2.2.3.8 搜索功能：第798-829行。</h5><p>next默认是没有开启搜索功能的，如果希望添加搜索功能需要进行设置。next集成了几家搜索服务商，本着能不注册尽量不注册能原装尽量不三方的原则，我选择的是local search这个本站搜索服务。设置它需要进行几步操作：</p>
<p>首先是把主题配置文件里<code>local search</code>下的<code>enable</code>值改为<code>true</code>。</p>
<p>第二步打开git bash，在里面输入命令<code>$ npm install hexo-generator-search --save</code>来安装这个搜索模块，这条命令可能会修改，可以去它的网页(<a href="https://github.com/wzpan/hexo-generator-search" target="_blank" rel="noopener">https://github.com/wzpan/hexo-generator-search</a>) 查看最新的命令。</p>
<p>第三步打开blog/_config.yml（注意不是主题配置文件而是blog文件夹下的那个），在里面新增一个<code>#search searvice</code>，把下面语句贴进去（或者先去上面网页查看它是否有什么最新修改）：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">search: </span><br><span class="line">  path: search.xml</span><br><span class="line">  field: post</span><br><span class="line">  content: <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<p>最后你可以设置搜索时是需要按回车才能开始搜索，还是在访客输字的同时就开始搜索了。如果需要按回车，在主题配置文件第820行的<code>trigger:</code>后的值设置为<code>manual</code>，如果要支持边输边搜，设置为<code>auto</code>即可。</p>
<p>以上是我个人在使用中发现的一些非常实用的功能的设置方法，但next所集成的功能还远不止于此，你还可以在next的主题设置文件中进行修改和设置，来显示你文章的阅读次数和热度统计、来设置支付宝或微信打赏、来在界面背景和鼠标上添加水纹线巢拖尾桃心等动态效果、来给图片增加放大和幻灯片视图等等等等。由于我没有相关需求也未进行相应设置，故不赘述。除此之外，对于github上的适用于hexo的开源功能插件，如果发现有自己喜欢的，即使你选用的主题没有集成，也可以根据那些插件的说明修改blog文件夹下的相应文件，把它们集成添加到你的博客页面中。</p>
<h3 id="2-3-编辑博文"><a href="#2-3-编辑博文" class="headerlink" title="2.3 编辑博文"></a>2.3 编辑博文</h3><p>我们终于设置好了博客界面，下面我们可以写博文了。可以选择一篇你过去写好的博文，看看怎么把它显示在浏览器中。</p>
<h4 id="2-3-1-用markdown语句编写博文"><a href="#2-3-1-用markdown语句编写博文" class="headerlink" title="2.3.1 用markdown语句编写博文"></a>2.3.1 用markdown语句编写博文</h4><p>博文的存放位置在blog/source/_posts文件夹中，点开它我们会发现这里已经有一个hello-world.md的文件，这就是我们在安装好hexo后就出现在我们博客页面上的那篇示例博文。如果我们想要新建一篇博文，可以输入命令，但更直观的方法是直接复制这个.md文件，然后打开去里面修改就可以了。</p>
<p>首先修改一些基本的博文设置，在最前面的<code>title:</code>后输入你博文的标题。在<code>tags:</code>后输入它的标签，设置多个标签的时候要写成<code>tags: [aaa, bbb, ccc]</code>，注意符号均需在英文输入法下输入，符号后均有空格。在<code>categories:</code>后输入它所属的分类，比如<code>categories: jcs</code>。注意如果要设置多层分类，比如我希望一篇文章属于musical大类下的jcs小类中，那么需要按顺序写在方括号中，即写成<code>categories: [musical, jcs]</code>。</p>
<p>然后我们进入到博文。.md文件里使用的是mardown语句，我们在编写博文的时候也需要使用它。如果你的博文是一个大长段，那么无需进行任何修改。如果里面有多层小标题，那么在每层标题前加上不同个数的#，比如第一层为<code>##</code>，第二层为<code>###</code>，以此类推，博文在显示时会把每一层标题相应的字体增大加粗，同时会用这些多层小标题自动生成博文的目录大纲。除此之外，还有一些常用的格式比如加粗需写为<code>**需加粗文字**</code>，斜体字需写为<code>*需斜体文字*</code>，更多的可以去搜索markdown常用语法。</p>
<h4 id="2-3-2-插入链接视频音频"><a href="#2-3-2-插入链接视频音频" class="headerlink" title="2.3.2 插入链接视频音频"></a>2.3.2 插入链接视频音频</h4><p>1) 如果需要在文章中插入链接，只需要按照下面这样写就可以了：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[点击它会跳转到链接的字](http://..链接地址)</span><br></pre></td></tr></table></figure>

<p>2) 如果希望插入视频，只需要把视频外链的iframe嵌入语句直接复制粘贴到希望视频框出现的位置就可以了。</p>
<p>以B站为例，打开希望插入的视频，点击转发按钮，在下面的复制链接中有一项嵌入代码，复制这一串代码，粘贴到博文的.md文件里即可。</p>
<p>3) 同理，插入音频也只需把音频外链的嵌入语句复制到博文的.md文件中希望它出现的博文位置处。</p>
<p>以网易云音乐为例，打开希望插入的音乐或者歌单，点击生成外链播放器，然后选择iframe插件，在勾选希望显示的播放器尺寸后，复制下面的html代码粘贴到.md文件里即可。</p>
<h4 id="2-3-3-插入图片"><a href="#2-3-3-插入图片" class="headerlink" title="2.3.3 插入图片"></a>2.3.3 插入图片</h4><p>之所以把图片单独列出来说，是因为这也是一个巨坑。hexo原本是有集成本地传图功能的，然而我尝试了各种方法，找了一堆解决方案，图片们仍然没法出现在博文里。最后我只好选择了放弃本地使用外链。然而安全稳定的支持外链相册也非常难找，目前暂时选择了sm.ms，优势是不用注册即传即生成外链，坏处是不知道哪天就会挂以及单图5m限制。于是我目前博客上需要图片的博文大都还没能搬运过去，因为我得先把图片们压缩到5m以内，这个浩大的工程只好缓缓图之。以后大约会尽量在写文章的时候减少对图片的使用了。这里也希望如果大噶有更好用的图床喂我安利！</p>
<p>一旦使用外链，插入图片就非常简单了。以下是插入图片的markdown语句，仍需注意符号们均需在英文输入法下输入，符号之间无空格：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">![如果图片不出来你希望在图片位置显示的文字](http://...图片链接地址)</span><br></pre></td></tr></table></figure>

<h2 id="3-把博客部署到网络上"><a href="#3-把博客部署到网络上" class="headerlink" title="3 把博客部署到网络上"></a>3 把博客部署到网络上</h2><p>$ hexo s一下，我们在localhost:4000里预览我们的本地博客觉得木啥问题以后，下一步就可以把它放到网上了。</p>
<h3 id="3-1-注册github并开通github-page"><a href="#3-1-注册github并开通github-page" class="headerlink" title="3.1 注册github并开通github page"></a>3.1 注册github并开通github page</h3><p>注册：在github网站(<a href="https://github.com/" target="_blank" rel="noopener">https://github.com/</a>) 用邮箱注册一个账号，注意在开通github page前需要先去邮箱验证过。</p>
<p>开通：登录github，点击右上角头像旁的小加号图标，在下拉菜单中选择new repository，打开新建一个仓库的页面。在Repository name的框里输入<code>xxx(你的github用户名).github.io</code>，这也会成为以后你博客网站的域名。</p>
<p>当然，如果你觉得这个域名不够酷炫，也可以绑定你自己购买的域名，只使用github的云服务器。绑定你购买的域名后，用你的购买域名或是xxx.github.io都可以访问到你的博客页面，只是在地址栏显示的会是你的购买域名。</p>
<h3 id="3-2-设置github使你的hexo文件可以在命令下上传到github-page上"><a href="#3-2-设置github使你的hexo文件可以在命令下上传到github-page上" class="headerlink" title="3.2 设置github使你的hexo文件可以在命令下上传到github page上"></a>3.2 设置github使你的hexo文件可以在命令下上传到github page上</h3><p>接下来我们需要把我们的博文传到github上，但上传必然是需要账号密码的。因此我们首先需要进行以下设置，才能在命令中直接把博文上传到网上。</p>
<h4 id="3-2-1-配置SSH-Key"><a href="#3-2-1-配置SSH-Key" class="headerlink" title="3.2.1 配置SSH Key"></a>3.2.1 配置SSH Key</h4><p>为保证安全，一个普通的密码是不够的，github需要你提交一个更复杂的SSH Key。这个key会包含一个私钥和一个公钥，一个放在你的电脑本地，另一个上传到github上，通过你的电脑和你的github账号上的SSH Key的配对来实现授权。</p>
<p>打开git bash，输入下面语句，然后回车3下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ssh-keygen -t rsa</span><br></pre></td></tr></table></figure>

<p>然后去C盘的用户文件夹下，会找到<code>id_rsa</code>和<code>id_rsa.pub</code>这两个新生成的文件。打开公钥文件<code>id_rsa.pub</code>，ctrl+a然后ctrl+c，把它添加到github上。</p>
<p>添加到github的位置是github页面右上角你的头像图标 - settings - ssh and gpg keys -new ssh key，ctrl+v到key框里就可以了，title则随便命名都可。</p>
<p>现在测试一下SSH Key是否配置成功了，在git bash里输入下面的语句：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ssh -T git@github.com</span><br></pre></td></tr></table></figure>

<p>如果返回的是<code>Are you sure you want to continue connecting (yes/no)?</code>，输入<code>yes</code>后，返回<code>Hi, xxx. You&#39;ve successfully...</code>则表示已经配置成功了。</p>
<h4 id="3-2-2-配置用户名和邮箱"><a href="#3-2-2-配置用户名和邮箱" class="headerlink" title="3.2.2 配置用户名和邮箱"></a>3.2.2 配置用户名和邮箱</h4><p>除了密码，我们仍需设置在github上的账户，因为，想像一下，如果你有两个github账号，电脑怎么知道一个命令下去应该把你的同人文传到二次元账号还是三次元账号下呢？因此，我们还需配置上传的账户，包括准备上传到的github账号的用户名和注册邮箱。</p>
<p>在git bash中输入下面的语句完成配置：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ git config --global user.name<span class="string">"xxx"</span></span><br><span class="line">$ git config --global user.email<span class="string">"xxx@163.com"</span></span><br></pre></td></tr></table></figure>

<p>其中xxx是你的github注册的用户名，<a href="mailto:xxx@163.com" target="_blank" rel="noopener">xxx@163.com</a>是你注册github时的注册邮箱，两个xxx未必是一致的。</p>
<h3 id="3-3-发布博文"><a href="#3-3-发布博文" class="headerlink" title="3.3 发布博文"></a>3.3 发布博文</h3><h4 id="3-3-1-修改博客配置文件"><a href="#3-3-1-修改博客配置文件" class="headerlink" title="3.3.1 修改博客配置文件"></a>3.3.1 修改博客配置文件</h4><p>前面我们对github进行了配置，让它知道谁会给它传文件了。但沟通是双向的，我们还需对电脑上的hexo进行设置，让它明白自己需要把博文传到哪里。</p>
<p>打开blog/_config.yml（注意，不是themes子文件夹下的那个同名文件），在最后添加上以下语句：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">deploy:</span><br><span class="line">  <span class="built_in">type</span>: git</span><br><span class="line">  repository: git@github.com:xxx/xxx.github.io.git</span><br><span class="line">  branch: master</span><br></pre></td></tr></table></figure>

<p>需要注意的是：<code>type:</code>后面是<code>git</code>，而不能是github；仓库<code>repository:</code>后面的格式和我们仓库的实际所在地地址不同，需要写成这样<code>git@github.com:xxx(github用户名)/xxx(github用户名).github.io.git</code>的格式。</p>
<h4 id="3-3-2-上传博文"><a href="#3-3-2-上传博文" class="headerlink" title="3.3.2 上传博文"></a>3.3.2 上传博文</h4><p>修改好配置文件，并确认你的博文.md文件已经放在blog/source/_post文件夹内后，打开git bash，首先输入下面语句，让hexo把你的.md文件转化为网页所需的html文件。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo g</span><br></pre></td></tr></table></figure>

<p>生成的准备上传的html文件会出现在你的blog/public文件夹里。接下来我们再把它上传到github上，继续在git bash中输入下面语句：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo d</span><br></pre></td></tr></table></figure>

<p>稍等几分钟等待上传完成，打开浏览器，输入你的域名<a href="https://xxx.github.io/" target="_blank" rel="noopener">https://xxx.github.io/</a> ，你就可以看到你的博文上传到网上啦。</p>
<p>以后每当更新了博文，就把.md格式的博文文件放在blog/source/_post文件夹下，然后<code>$ hexo s</code>本地预览无误后，<code>$ hexo g</code>再<code>$ hexo d</code>即可。</p>
<p>如果发现更新后的显示有误，尤其是一些做了修改的旧文仍然显示为修改前的样子时，可以在git bash中先输入<code>$ hexo clean</code>，这会把public文件夹的文件清空，然后再<code>$ hexo g</code>生成新的public文件，最后<code>$ hexo d</code>重新上传到github。</p>
<p>以上。祝大家在博客玩得开森。</p>

        
      
    </div>

    
    
    
      <footer class="post-footer">
          <div class="post-eof"></div>
        
      </footer>
  </div>
  
  
  
  </article>

       
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
       
        <article itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block home">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/10/03/subtitle-zh-gc-interview-2018/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Brielley">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Brielley">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
            
            <a href="/2019/10/03/subtitle-zh-gc-interview-2018/" class="post-title-link" itemprop="url">【翻译】John Hannam Meets Glenn Carter <i class="fa fa-music"></i></a>
          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              
                
              

              <time title="Created: 2019-10-03 13:06:24" itemprop="dateCreated datePublished" datetime="2019-10-03T13:06:24+08:00">2019-10-03</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2021-03-23 15:01:22" itemprop="dateModified" datetime="2021-03-23T15:01:22+08:00">2021-03-23</time>
              </span>
            
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Life/" itemprop="url" rel="index"><span itemprop="name">Life</span></a></span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Life/Translation/" itemprop="url" rel="index"><span itemprop="name">Translation</span></a></span>

                
                
              
            </span>
          

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>万世巨星2000版耶稣扮演者Glenn Carter在2018年11月的<a href="https://www.bilibili.com/video/BV1Bt411e7WT" target="_blank" rel="noopener">采访</a>。<br>访谈主要是宣传艾薇塔18英巡，当然，卡特作为一个四舍五入演了一辈子的JC专业户，JCS也是不可避免的话题。</p>
<p>Credit：音频与英字 by <a href="http://oliviay113.lofter.com/" target="_blank" rel="noopener">OliviaY</a></p>
<hr>
<h3 id="从万年替补到万世巨星"><a href="#从万年替补到万世巨星" class="headerlink" title="从万年替补到万世巨星"></a>从万年替补到万世巨星</h3><p>John Hannam: Delighted to welcome Glenn Carter to John Hannam Meets, nice to meet you.</p>
<p>Glenn Carter: Yes, lovely to meet you too.</p>
<p>约翰：非常荣幸邀请到了格伦卡特来到今天的遇见约翰汉娜节目。很高兴见到你，卡特。</p>
<p>卡特：很高兴见到大家。</p>
          <!--noindex-->
          
            <div class="post-button">
              <a class="btn" href="/2019/10/03/subtitle-zh-gc-interview-2018/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
          <div class="post-eof"></div>
        
      </footer>
  </div>
  
  
  
  </article>

       
    
      
    
      
    
  </div>

  


          </div>
          

        </div>
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Brielley</p>
  <div class="site-description" itemprop="description"></div>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
      
      
        
      
      
        
      
        <a href="mailto:brielley@163.com" title="Email Me &rarr; mailto:brielley@163.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>Email Me</a>
      </span>
    
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2019 – <span itemprop="copyrightYear">2021</span>
  <span class="with-love" id="animate">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Brielley  All Rights Reserved</span>
</div>

        












        
      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js?v=3.1.0"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
<script src="/js/utils.js?v=7.4.0"></script><script src="/js/motion.js?v=7.4.0"></script>
<script src="/js/schemes/muse.js?v=7.4.0"></script>

<script src="/js/next-boot.js?v=7.4.0"></script>



  








  <script src="/js/local-search.js?v=7.4.0"></script>














  

  

  


</body>
</html>
